import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import{cache_default as e}from"./cache-C3AIQtoX.js";import{art as t}from"./render-DE4LRFBD.js";import{ofetch_default as n}from"./ofetch-DRl42yaJ.js";import{__dirname as r}from"./esm-shims-BDPl6Msv.js";import{rss_parser_default as i}from"./rss-parser-Dx7FersL.js";import a from"node:path";import{load as o}from"cheerio";const s={path:`/:hub?`,categories:[`new-media`],example:`/theverge`,parameters:{hub:`Hub, see below, All Posts by default`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`theverge.com/:hub`,`theverge.com/`]}],name:`Category`,maintainers:[`HenryQW`,`vbali`],handler:l,description:`| Hub         | Hub name            |
| ----------- | ------------------- |
|             | All Posts           |
| android     | Android             |
| apple       | Apple               |
| apps        | Apps & Software     |
| blackberry  | BlackBerry          |
| culture     | Culture             |
| gaming      | Gaming              |
| hd          | HD & Home           |
| microsoft   | Microsoft           |
| photography | Photography & Video |
| policy      | Policy & Law        |
| web         | Web & Social        |

  Provides a better reading experience (full text articles) over the official one.`},c=e=>{switch(e.__typename){case`CoreEmbedBlockType`:return e.embedHtml;case`CoreGalleryBlockType`:return e.images.map(e=>`<figure><img src="${e.image.thumbnails.horizontal.url.split(`?`)[0]}" alt="${e.alt}" /><figcaption>${e.caption.html}</figcaption></figure>`).join(``);case`CoreHeadingBlockType`:return`<h${e.level}>${e.contents.html}</h${e.level}>`;case`CoreHTMLBlockType`:return e.markup;case`CoreImageBlockType`:return`<figure><img src="${e.thumbnail.url.split(`?`)[0]}" alt="${e.alt}" /><figcaption>${e.caption.html}</figcaption></figure>`;case`CoreListBlockType`:return`${e.ordered?`<ol>`:`<ul>`}${e.items.map(e=>`<li>${e.contents.html}</li>`).join(``)}${e.ordered?`</ol>`:`</ul>`}`;case`CoreParagraphBlockType`:return e.contents.html;case`CorePullquoteBlockType`:return`<blockquote>${e.contents.html}</blockquote>`;case`CoreQuoteBlockType`:return`<blockquote>${e.children.map(e=>c(e)).join(``)}</blockquote>`;case`CoreSeparatorBlockType`:return`<hr>`;case`HighlightBlockType`:return e.children.map(e=>c(e)).join(``);case`MethodologyAccordionBlockType`:return`<h2>${e.heading.html}</h2>${e.sections.map(e=>`<h3>${e.heading.html}</h3>${e.content.html}`).join(``)}`;default:throw Error(`Unsupported block type: ${e.__typename}`)}};async function l(s){let l=s.req.param(`hub`)?`https://www.theverge.com/${s.req.param(`hub`)}/rss/index.xml`:`https://www.theverge.com/rss/index.xml`,u=await i.parseURL(l),d=await Promise.all(u.items.map(i=>e.tryGet(i.link,async()=>{let e=await n(i.link),s=o(e),l=JSON.parse(s(`script#__NEXT_DATA__`).text()),u=l.props.pageProps.hydration.responses.find(e=>e.operationName===`PostLayoutQuery`||e.operationName===`StreamLayoutQuery`).data.node,d=t(a.join(r,`templates/header-f05d88a8.art`),{featuredImage:u.featuredImage,ledeMediaData:u.ledeMediaData});return d+=u.blocks.filter(e=>e.__typename!==`NewsletterBlockType`&&e.__typename!==`RelatedPostsBlockType`&&e.__typename!==`ProductBlockType`&&e.__typename!==`TableOfContentsBlockType`).map(e=>c(e)).join(`<br><br>`),u.__typename===`StreamResourceType`&&(d+=u.posts.edges.map(({node:e})=>{let n=`<h2><a href="${e.permalink}">${e.promo.headline||e.title}</a></h2>`+t(a.join(r,`templates/header-f05d88a8.art`),{ledeMediaData:e.ledeMediaData});switch(e.__typename){case`PostResourceType`:n+=e.excerpt.map(e=>e.contents.html).join(`<br>`);break;case`QuickPostResourceType`:n+=e.blocks.map(e=>c(e)).join(`<br>`);break;default:break}return n}).join(`<br>`)),i.description=d,i.category=u.categories,i})));return{title:u.title,link:u.link,description:u.description,item:d}}export{s as route};