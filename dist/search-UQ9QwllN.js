import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import"./helpers-LVq640iW.js";import{art as e}from"./render-DE4LRFBD.js";import{parseDate as t}from"./parse-date-DHsdom8D.js";import"./ofetch-DRl42yaJ.js";import{__dirname as n}from"./esm-shims-BDPl6Msv.js";import{got_default as r}from"./got-BaOFZRd4.js";import{timezone as i}from"./timezone-BrxBCotj.js";import a from"node:path";import{load as o}from"cheerio";import s from"iconv-lite";const c={path:`/tieba/search/:qw/:routeParams?`,categories:[`bbs`],example:`/baidu/tieba/search/neuro`,parameters:{qw:`搜索关键词`,routeParams:`额外参数；请参阅以下说明和表格`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`贴吧搜索`,maintainers:[`JimenezLi`],handler:l,description:`| 键           | 含义                                                       | 接受的值      | 默认值 |
| ------------ | ---------------------------------------------------------- | ------------- | ------ |
| kw           | 在名为 kw 的贴吧中搜索                                     | 任意名称 / 无 | 无     |
| only_thread  | 只看主题帖，默认为 0 关闭                                  | 0/1           | 0      |
| rn           | 返回条目的数量                                             | 1-20          | 20     |
| sm           | 排序方式，0 为按时间顺序，1 为按时间倒序，2 为按相关性顺序 | 0/1/2         | 1      |

  用例：\`/baidu/tieba/search/neuro/kw=neurosama&only_thread=1&sm=2\``};async function l(c){let l=c.req.param(`qw`),u=new URLSearchParams(c.req.param(`routeParams`));u.set(`ie`,`utf-8`),u.set(`qw`,l),u.set(`rn`,u.get(`rn`)||`20`);let d=`https://tieba.baidu.com/f/search/res?${u.toString()}`,f=await r.get(d,{headers:{Referer:`https://tieba.baidu.com`},responseType:`buffer`}),p=s.decode(f.data,`gbk`),m=o(p),h=m(`div.s_post`);return{title:`${l} - ${u.get(`kw`)||`百度贴`}吧搜索`,link:d,item:h.toArray().map(r=>{let o=m(r),s=o.find(`.p_title a`),c=s.text().trim(),l=s.attr(`href`),u=o.find(`.p_date`).text().trim(),d=o.find(`.p_content`).text().trim(),f=o.find(`.p_mediaCont img`).toArray().map(e=>{let t=m(e);return`<img src="${t.attr(`original`)}">`}).join(``),p=o.find(`a.p_forum`).text().trim(),h=o.find(`a`).last().text().trim();return{title:c,description:e(a.join(n,`templates/tieba_search-a766b6b5.art`),{details:d,medias:f,tieba:p,author:h}),author:h,pubDate:i(t(u,`YYYY-MM-DD HH:mm`),8),link:l}})}}export{c as route};