import{art as e}from"./render-DE4LRFBD.js";import{parseDate as t}from"./parse-date-DHsdom8D.js";import{__dirname as n}from"./esm-shims-BDPl6Msv.js";import{got_default as r}from"./got-BaOFZRd4.js";import i from"node:path";import a from"dayjs";const o=`readhub.cn`,s=`https://${o}`,c=`https://api.${o}`,l=new URL(`topic/list`,c).href,u=(e,t)=>a(e).format(t),d=e=>new URL(`topic/${e}`,s).href;e.defaults.imports={...e.defaults.imports,formatDate:u,toTopicUrl:d};const f=async(a,o)=>await Promise.all(a.map(a=>o(a.link,async()=>{try{if(!a.link.startsWith(s))throw Error(`"${a.link}" is an external URL`);let{data:o}=await r(a.link),c=JSON.parse(o.match(/{\\"topic\\":(.*?)}]\\n"]\)<\/script>/)[1].replaceAll(String.raw`\"`,`"`));a.title=c.title,a.link=c.url??new URL(`topic/${c.uid}`,s).href,a.description=e(i.join(n,`templates/description-71daa88b.art`),{description:c.summary,news:c.newsAggList,timeline:c.timeline}),a.author=c.siteNameDisplay,a.category=[...c.entityList.map(e=>e.name)??[],...c.tagList.map(e=>e.name)??[]],a.guid=`readhub-${c.uid}`,a.pubDate=t(c.publishDate.replaceAll(/\s/g,``))}catch{a.guid=`readhub-${a.guid}`}return a})));export{c as apiRootUrl,l as apiTopicUrl,f as processItems,s as rootUrl};