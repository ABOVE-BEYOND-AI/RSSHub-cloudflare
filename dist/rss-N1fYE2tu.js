import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import"./helpers-LVq640iW.js";import{cache_default as e}from"./cache-C3AIQtoX.js";import{art as t}from"./render-DE4LRFBD.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import"./ofetch-DRl42yaJ.js";import{__dirname as r}from"./esm-shims-BDPl6Msv.js";import{got_default as i}from"./got-BaOFZRd4.js";import a from"node:path";import{load as o}from"cheerio";const s={path:`/:category?`,categories:[`new-media`],example:`/secretsanfrancisco/top-news`,parameters:{category:`category name, can be found in url`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`secretsanfrancisco.com/:category`],target:`/:category`}],name:`Category`,maintainers:[`EthanWng97`],handler:c};async function c(s){let c=`https://secretsanfrancisco.com`,l=`/wp-json/wp/v2/categories`,u=s.req.param(`category`)||``,d;u&&(d=await e.tryGet(`${c}${l}`,async()=>{let{data:e}=await i(`${c}${l}`,{searchParams:{slug:u}});if(!e||e.length===0)throw Error(`Category "${u}" not found`);return e[0]}));let f=d?.id,p=d?.name,m=d?.link,h=`${c}/wp-json/wp/v2/posts`,g=await i(h,{searchParams:{per_page:s.req.query(`limit`)?Number.parseInt(s.req.query(`limit`)):10,_embed:``,...f&&{categories:f}}}),_=g.data.filter(e=>e.language===`en`).map(e=>{let i=e._embedded?.[`wp:featuredmedia`]?.find(t=>t.id===e.featured_media),s=i?.source_url,c=i?.alt_text||i?.title?.rendered,l;i?.caption?.rendered&&(l=o(i?.caption?.rendered));let u={title:e.title.rendered,description:t(a.join(r,`templates/description-1c044b73.art`),{content:e.content.rendered,image:s,altText:c,caption:l?.text()||``}),link:e.link,pubDate:n(e.date_gmt),updated:n(e.modified_gmt),image:s,author:e._embedded.author[0].name};return u});return{title:p?`Secret San Francisco - ${p}`:`Secret San Francisco`,link:m||`${c}/${u}`,item:_}}export{s as route};