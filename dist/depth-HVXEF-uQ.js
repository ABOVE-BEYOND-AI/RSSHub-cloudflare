import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import"./helpers-LVq640iW.js";import{cache_default as e}from"./cache-C3AIQtoX.js";import{art as t}from"./render-DE4LRFBD.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import"./ofetch-DRl42yaJ.js";import{__dirname as r}from"./esm-shims-BDPl6Msv.js";import{got_default as i}from"./got-BaOFZRd4.js";import{invalid_parameter_default as a}from"./invalid-parameter-CfUmvEUg.js";import{getSearchParams as o,rootUrl as s}from"./utils-C_M_Hqf8.js";import c from"node:path";import{load as l}from"cheerio";const u={1e3:`头条`,1003:`股市`,1135:`港股`,1007:`环球`,1005:`公司`,1118:`券商`,1110:`基金`,1006:`地产`,1032:`金融`,1119:`汽车`,1111:`科创`,1127:`创业版`,1160:`品见`,1124:`期货`,1176:`投教`},d={path:`/depth/:category?`,categories:[`finance`],example:`/cls/depth/1000`,parameters:{category:`分类代码，可在首页导航栏的目标网址 URL 中找到`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`深度`,maintainers:[`nczitzk`],handler:f,description:`| 头条 | 股市 | 港股 | 环球 | 公司 | 券商 | 基金 | 地产 | 金融 | 汽车 | 科创 | 创业版 | 品见 | 期货 | 投教 |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ------ | ---- | ---- | ---- |
| 1000 | 1003 | 1135 | 1007 | 1005 | 1118 | 1110 | 1006 | 1032 | 1119 | 1111 | 1127   | 1160 | 1124 | 1176 |`};async function f(d){let f=d.req.param(`category`)??`1000`,p=d.req.query(`limit`)?Number.parseInt(d.req.query(`limit`)):50,m=u[f];if(!m)throw new a(`Bad category. See <a href="https://docs.rsshub.app/routes/finance#cai-lian-she-shen-du">docs</a>`);let h=`${s}/v3/depth/home/assembled/${f}`,g=`${s}/depth?id=${f}`,_=await i({method:`get`,url:h,searchParams:o()}),v=[..._.data.data.top_article,..._.data.data.depth_list].slice(0,p).map(e=>({title:e.title||e.brief,link:`${s}/detail/${e.id}`,pubDate:n(e.ctime*1e3),author:e.source}));return v=await Promise.all(v.map(n=>e.tryGet(n.link,async()=>{let e=await i({method:`get`,url:n.link}),a=l(e.data),o=JSON.parse(a(`script#__NEXT_DATA__`).text()),s=o.props.initialState.detail.articleDetail;return n.author=s.author?.name??n.author??``,n.description=t(c.join(r,`templates/depth-39e6d921.art`),{articleDetail:s}),n}))),{title:`财联社 - ${m}`,link:g,item:v}}export{d as route};