import{config as e}from"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import"./cache-C3AIQtoX.js";import{art as t}from"./render-DE4LRFBD.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import"./ofetch-DRl42yaJ.js";import{__dirname as r}from"./esm-shims-BDPl6Msv.js";import{config_not_found_default as i}from"./config-not-found-B7nOMdXp.js";import{baseUrl as a,getChannel as o,getChannelMessages as s,getGuild as c}from"./discord-api-uyOvnWT_.js";import l from"node:path";const u={path:`/channel/:channelId`,categories:[`social-media`],example:`/discord/channel/950465850056536084`,parameters:{channelId:`Channel ID`},features:{requireConfig:[{name:`DISCORD_AUTHORIZATION`,description:`Discord authorization header from the browser`}],requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`discord.com/channels/:guildId/:channelId/:messageID`,`discord.com/channels/:guildId/:channelId`]}],name:`Channel Messages`,maintainers:[`TonyRL`],handler:d};async function d(u){if(!e.discord||!e.discord.authorization)throw new i(`Discord RSS is disabled due to the lack of <a href="https://docs.rsshub.app/deploy/config#route-specific-configurations">relevant config</a>`);let{authorization:d}=e.discord,f=u.req.param(`channelId`),p=await o(f,d),m=await s(f,d,u.req.query(`limit`)??100),{name:h,topic:g,guild_id:_}=p,v=await c(_,d),{name:y,icon:b}=v,x=m.map(e=>({title:e.content.split(`
`)[0],description:t(l.join(r,`templates/message-311bc85b.art`),{message:e,guildInfo:v}),author:`${e.author.global_name??e.author.username}(${e.author.username})`,pubDate:n(e.timestamp),updated:e.edited_timestamp?n(e.edited_timestamp):void 0,category:`#${h}`,link:`${a}/channels/${_}/${f}/${e.id}`}));return{title:`#${h} - ${y} - Discord`,description:g,link:`${a}/channels/${_}/${f}`,image:`https://cdn.discordapp.com/icons/${_}/${b}.webp`,item:x,allowEmpty:!0}}export{u as route};