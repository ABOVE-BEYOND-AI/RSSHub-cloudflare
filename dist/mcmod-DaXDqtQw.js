import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import{cache_default as e}from"./cache-C3AIQtoX.js";import{art as t}from"./render-DE4LRFBD.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import{ofetch_default as r}from"./ofetch-DRl42yaJ.js";import{__dirname as i}from"./esm-shims-BDPl6Msv.js";import{timezone as a}from"./timezone-BrxBCotj.js";import o from"node:path";import{load as s}from"cheerio";const c=e=>t(o.join(i,`templates/mod-810bfe96.art`),{mod:e}),l={path:`/:type`,categories:[`game`],example:`/mcmod/new`,parameters:{type:`查询类型，详见下表`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`最新MOD`,maintainers:[`hualiong`],description:`\`:type\` 类型可选如下

| 随机显示MOD | 最新收录MOD | 最近编辑MOD |
| ------ | --- | ---- |
| random | new | edit |`,handler:async t=>{let i=t.req.param(`type`),o=r.create({baseURL:`https://www.mcmod.cn`}),l=await o(`/`),u=s(l),d=u(`div.left > ul > li[i='${i}']`).attr(`title`),f=u(`#indexNew_${i} > .block`).toArray().map(e=>{let t=u(e),r=t.find(`div .time`);return{title:t.find(`div > .name > a`).text(),image:t.find(`img`).attr(`src`)?.split(`@`)[0],link:t.children(`a`).attr(`href`),pubDate:r.attr(`title`)&&a(n(r.attr(`title`).slice(6),`YYYY-MM-DD HH:mm:ss`),8)}}),p=await Promise.all(f.map(t=>e.tryGet(t.link,async()=>{let e=await o(t.link),n=s(e);t.author=n(`.author li`).toArray().map(e=>{let t=n(e),r=t.find(`.name a`);return{name:r.text(),url:`https://www.mcmod.cn`+r.attr(`href`),avatar:t.find(`.avatar img`).attr(`src`)?.split(`?`)[0]}});let r=n(`.common-text[data-id="1"]`).html(),i=n(`.mcver > ul > ul`).toArray().map(e=>{let t=n(e),r=t.children(`li:first-child`).text(),i=t.children(`li:not(:first-child)`).toArray().map(e=>n(e).text()).join(`，`);return{label:r,versions:i}});return t.description=c({pic:`https:`+t.image,label:n(`.class-info  li.col-lg-4`).toArray().map(e=>n(e).text()),support:i})+r.replaceAll(/\ssrc=".+?"/g,``).replaceAll(`data-src`,`src`),t})));return{title:`${d} - MC百科`,description:u(`meta[name="description"]`).attr(`content`),link:`https://www.mcmod.cn`,item:p}}};export{l as route};