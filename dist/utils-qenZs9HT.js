import{art as e}from"./render-DE4LRFBD.js";import{parseDate as t}from"./parse-date-DHsdom8D.js";import{ofetch_default as n}from"./ofetch-DRl42yaJ.js";import{__dirname as r}from"./esm-shims-BDPl6Msv.js";import i from"node:path";const a=`https://www.newslaundry.com`;async function o(e,t,r=!1){let i=`${a}/api/v1/collections/${e}`,o=t||`${a}/${e}`,c=await n(i);if(!c.items||!c.items.length)throw Error(`No articles found`);let l=r?c.items.slice(1):c.items,u=l.map(e=>s(e.story));return{title:`${c.name} - Newslaundry`,description:c.summary||`${c.name} articles from Newslaundry`,link:o,item:u,language:`en`,logo:`${a}/favicon.ico`,icon:`${a}/favicon.ico`}}function s(n){let o=n.url,s=n[`published-at`]?t(n[`published-at`]):null,c=n[`hero-image-s3-key`]?`https://media.assettype.com/${n[`hero-image-s3-key`]}?auto=format%2Ccompress&fit=max&dpr=1.0&format=webp`:null,l=n.cards?.flatMap(e=>e?.[`story-elements`]?.map(e=>{if(e.type===`text`&&e.text)return{type:`text`,text:e.text};if(e.type===`image`&&e[`image-s3-key`])return{type:`image`,url:`https://media.assettype.com/${e[`image-s3-key`]}?auto=format%2Ccompress&format=webp`,alt:e[`alt-text`]||``,title:e.title||``};if(e.type===`jsembed`&&e[`embed-js`])try{return{type:`jsembed`,content:Buffer.from(e[`embed-js`],`base64`).toString()}}catch{return null}else if(e.type===`youtube-video`&&e.url)return{type:`youtube-video`,url:e.url,embedUrl:e[`embed-url`]||``};return null}).filter(Boolean)||[])||[],u=e(i.join(r,`templates/description-d23336fb.art`),{heroImage:c,heroAlt:n[`hero-image-alt-text`]||``,heroCaption:n[`hero-image-caption`]||``,heroAttribution:n[`hero-image-attribution`],elements:l,subheadline:n.subheadline}),d=n.authors?.map(e=>({name:e.name,url:e.slug?`${a}/author/${e.slug}`:void 0}))||[];return{title:n.headline,link:o,image:c,description:u||n.subheadline,pubDate:s,updated:n[`last-correction-published-at`]?t(n[`last-correction-published-at`]):void 0,author:d.length>0?d:n[`author-name`],category:n.tags?.map(e=>e.name)||[]}}export{o as fetchCollection,a as rootUrl};