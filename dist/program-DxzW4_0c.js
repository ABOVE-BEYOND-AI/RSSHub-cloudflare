import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import"./helpers-LVq640iW.js";import{cache_default as e}from"./cache-C3AIQtoX.js";import{art as t}from"./render-DE4LRFBD.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import"./ofetch-DRl42yaJ.js";import{__dirname as r}from"./esm-shims-BDPl6Msv.js";import{got_default as i}from"./got-BaOFZRd4.js";import a from"node:path";import{load as o}from"cheerio";const s={path:`/v/:category{.+}?`,name:`Unknown`,maintainers:[],handler:c};async function c(s){let{category:c=`sdws/sdxwlb`}=s.req.param(),l=s.req.query(`limit`)?Number.parseInt(s.req.query(`limit`),10):30,u=`http://v.iqilu.com`,d=new URL(c,u).href,{data:f}=await i(d),p=o(f),m=p(`#jmzhanshi1 dl`).slice(0,l).toArray().map(e=>{e=p(e);let i=e.find(`a`).first(),o=e.find(`img`).first();return e.find(`dd`).last().remove(),{title:i.prop(`title`),link:i.prop(`href`),description:t(a.join(r,`templates/description-8d3391c3.art`),{image:{src:o.prop(`src`),alt:o.prop(`alt`)}}),pubDate:n(e.find(`dd`).last().text().match(/(\d{4}-\d{2}-\d{2})/)[1]),itunes_item_image:o.prop(`src`)}});m=await Promise.all(m.map(n=>e.tryGet(n.link,async()=>{let{data:e}=await i(n.link),s=o(e);return n.title=s(`div.vtitle`).text(),n.enclosure_url=s(`#copy_mp4text`).prop(`value`),n.enclosure_type=n.enclosure_url?`video/${n.enclosure_url.split(/\./).pop()}`:void 0,n.description=t(a.join(r,`templates/description-8d3391c3.art`),{image:{src:n.itunes_item_image,alt:n.title},video:{src:n.enclosure_url,type:n.enclosure_type},description:s(`div.vinfo`).text().trim()}),n})));let h=new URL(p(`link[rel="icon"]`).prop(`href`),u).href,g=p(`div.host_pic dl dd a`).toArray().map(e=>p(e).text()).join(`/`);return{item:m,title:p(`title`).text(),link:d,description:p(`meta[name="description"]`).prop(`content`),language:p(`html`).prop(`lang`),image:p(`div.s_logo img`).prop(`src`),icon:h,logo:h,subtitle:p(`meta[name="keywords"]`).prop(`content`),author:g,itunes_author:g,itunes_category:`News`,allowEmpty:!0}}export{s as route};