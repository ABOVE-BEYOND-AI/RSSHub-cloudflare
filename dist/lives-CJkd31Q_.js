import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import"./helpers-LVq640iW.js";import{art as e}from"./render-DE4LRFBD.js";import{parseDate as t}from"./parse-date-DHsdom8D.js";import"./ofetch-DRl42yaJ.js";import{__dirname as n}from"./esm-shims-BDPl6Msv.js";import{got_default as r}from"./got-BaOFZRd4.js";import{ViewType as i}from"./types-D9T3SQ-7.js";import a from"node:path";import{load as o}from"cheerio";const s={0:`全部`,1:`精选`,2:`政策`,3:`数据`,4:`NFT`,5:`项目`},c={path:`/lives/:category?`,categories:[`finance`],view:i.Notifications,example:`/jinse/lives`,parameters:{category:{description:`分类`,options:Object.entries(s).map(([e,t])=>({value:e,label:t})),default:`0`}},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`快讯`,maintainers:[`nczitzk`],handler:l,description:`| 全部 | 精选 | 政策 | 数据 | NFT | 项目 |
| ---- | ---- | ---- | ---- | --- | ---- |
| 0    | 1    | 2    | 3    | 4   | 5    |`};async function l(i){let{category:c=`0`}=i.req.param(),l=i.req.query(`limit`)?Number.parseInt(i.req.query(`limit`),10):100,u=`https://jinse.cn`,d=new URL(`noah/v2/lives`,`https://api.jinse.cn`).href,f=new URL(`lives`,u).href,{data:p}=await r(d,{searchParams:{limit:l,reading:!1,source:`web`,flag:`up`,id:0,category:c}}),m=p.list.flatMap(e=>e.lives).slice(0,l).map(r=>({title:r.content_prefix,link:new URL(`lives/${r.id}.html`,u).href,description:e(a.join(n,`templates/description-d03b585b.art`),{images:r.images?.map(e=>({src:e.url.replace(/_[^\W_]+(\.\w+)$/,`_true$1`),width:e.width,height:e.height}))??[],description:r.content,original:r.link?{link:r.link,name:r.link_name}:void 0}),author:r.show_source_name,guid:`jinse-lives-${r.id}`,pubDate:t(r.created_at,`X`),upvotes:r.up_counts??0,downvotes:r.down_counts??0,comments:r.comment_count??0}))??[],{data:h}=await r(f),g=o(h),_=g(`meta[name="author"]`).prop(`content`),v=g(`a.js-logoBox img`).prop(`src`),y=new URL(g(`link[rel="favicon"]`).prop(`href`),u).href;return{item:m,title:`${_} - ${Object.hasOwn(s,c)?s[c]:c}`,link:f,description:g(`meta[name="description"]`).prop(`content`),language:g(`html`).prop(`lang`),image:v,icon:y,logo:y,subtitle:g(`meta[name="keywords"]`).prop(`content`),author:_,allowEmpty:!0}}export{c as route};