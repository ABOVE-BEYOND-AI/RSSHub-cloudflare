import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import{art as e}from"./render-DE4LRFBD.js";import{ofetch_default as t}from"./ofetch-DRl42yaJ.js";import{__dirname as n}from"./esm-shims-BDPl6Msv.js";import{ViewType as r}from"./types-D9T3SQ-7.js";import i from"node:path";import*as a from"cheerio";const o=t=>e(i.join(n,`templates/chart-2e926210.art`),t),s={path:`/chart/:chart?`,categories:[`multimedia`],view:r.Notifications,parameters:{chart:{description:"The chart to display, `top` by default",options:[{value:`top`,label:`Top 250 Movies`},{value:`moviemeter`,label:`Most Popular Movies`},{value:`toptv`,label:`Top 250 TV Shows`},{value:`tvmeter`,label:`Most Popular TV Shows`}],default:`top`}},example:`/imdb/chart`,radar:[{source:[`www.imdb.com/chart/:chart/`]}],name:`Charts`,maintainers:[`TonyRL`],handler:c,url:`www.imdb.com/chart/top/`,description:`| Top 250 Movies | Most Popular Movies | Top 250 TV Shows | Most Popular TV Shows |
| -------------- | ------------------- | ---------------- | --------------------- |
| top            | moviemeter          | toptv            | tvmeter               |`};async function c(e){let{chart:n=`top`}=e.req.param(),r=`https://www.imdb.com`,i=`${r}/chart/${n}/`,s=await t(i),c=a.load(s),l=JSON.parse(c(`script#__NEXT_DATA__`).text()),u=l.props.pageProps.pageData.chartTitles,d=u.edges.map(({currentRank:e,node:t})=>({title:`${e}. ${t.titleText.text} (${t.releaseYear.year}${t.releaseYear.endYear?`-${t.releaseYear.endYear}`:``})`,description:o({primaryImage:t.primaryImage,originalTitleText:t.originalTitleText,certificate:t.certificate,ratingsSummary:t.ratingsSummary,plot:t.plot}),link:`${r}/title/${t.id}`,category:t.titleGenres.genres.map(e=>u.genres.find(t=>t.filterId===e.genre.text)?.text)}));return{title:c(`head title`).text(),description:c(`head meta[name="description"]`).attr(`content`),link:i,item:d}}export{s as route};