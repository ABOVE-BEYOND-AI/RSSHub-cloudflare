import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import"./helpers-LVq640iW.js";import{cache_default as e}from"./cache-C3AIQtoX.js";import{art as t}from"./render-DE4LRFBD.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import"./ofetch-DRl42yaJ.js";import{__dirname as r}from"./esm-shims-BDPl6Msv.js";import{got_default as i}from"./got-BaOFZRd4.js";import a from"node:path";import{load as o}from"cheerio";const s=async s=>{let{conference:c}=s.req.param(),l=s.req.query(`limit`)?Number.parseInt(s.req.query(`limit`),10):12,u=`https://www.infoq.com`,d=new URL(`${c?`${c}/`:``}presentations/`,u).href,{data:f}=await i(d),p=o(f),m=p(`html`).prop(`lang`),h=p(`ul[data-tax="presentations"] li[data-path]`).slice(0,l).toArray().map(e=>{e=p(e);let i=e.find(`h3.card__title a`),o=i.prop(`title`)||i.text().trim(),s=e.find(`img.card__image`).prop(`src`),c=t(a.join(r,`templates/description-36fefaf3.art`),{images:s?[{src:s,alt:o}]:void 0,intro:e.find(`p.card__excerpt`).text()}),l=new URL(i.prop(`href`),u).href,d=`infoq-${e.prop(`data-path`).replace(/^\//,``)}`,f=e.find(`div.card__length`).text()||void 0;return{title:o,description:c,pubDate:n(e.find(`span.card__date span`).text().trim()),link:l,category:e.find(`div.card__topics`).toArray().map(e=>p(e).text().trim()),author:e.find(`div.card__authors a`).toArray().map(e=>p(e).text().trim()).join(`/`),guid:d,id:d,content:{html:c,text:e.find(`p.card__excerpt`).text()},image:s,banner:s,language:m,enclosure_url:f?l:void 0,enclosure_type:f?`video/mp4`:void 0,enclosure_title:o,itunes_duration:f}});h=await Promise.all(h.map(s=>e.tryGet(s.link,async()=>{let{data:e}=await i(s.link),c=o(e);c(`div.player`).prevAll().remove(),c(`div.event__list-box`).remove();let l=c(`div.player__actions span`).text()||void 0,u=c(`script[type="text/javascript"]`).text(),d=u.match(/P\.s\s=\s'(.*?)';/)?.[1]??void 0,f=u.match(/P\.c\(.*?isWideScreen,\s'(.*?)',\s/)?.[1]??void 0,p=u.match(/var\stopicsInPage\s=\sJSON\.parse\('(.*?)'\);/)?.[1]?.replace(/\\/g,``)??void 0;d&&c(`div.player`).replaceWith(t(a.join(r,`templates/description-36fefaf3.art`),{videos:[{src:d,poster:f,type:`video/${d.split(/\./).pop()}`}]}));let h=c(`meta[property="og:title"]`).prop(`content`).trim(),g=c(`meta[property="twitter:image"]`).prop(`content`)||c(`meta[property="og:image"]`).prop(`content`);s.title=h,s.pubDate=n(c(`p.date`).text()),s.link=c(`meta[property="og:url"]`).prop(`content`),s.category=p?JSON.parse(p).map(e=>e.name):c(`meta[name="keywords"]`).prop(`content`).split(/,/),s.author=c(`ul.authors a.author__link`).toArray().map(e=>c(e).text()).join(`/`),c(`div.article__content`).nextAll().remove();let _=t(a.join(r,`templates/description-36fefaf3.art`),{images:g?[{src:g,alt:h}]:void 0,description:c(`article.article`).html()});return s.description=_,s.content={html:_,text:c(`article.article`).text()},s.image=g,s.banner=g,s.language=m,s.enclosure_url=d,s.enclosure_type=s.enclosure_url?`video/mp4`:void 0,s.enclosure_title=h,s.itunes_duration=l,s})));let g=p(`title`).text(),_=p(`meta[property="og:image"]`).prop(`content`);return{title:g,description:p(`meta[name="description"]`).prop(`content`),link:d,item:h,allowEmpty:!0,image:_,author:g.split(/-/).pop(),language:m}},c={path:`/presentations/:conference?`,name:`Presentations`,url:`www.infoq.com`,maintainers:[`nczitzk`],handler:s,example:`/infoq/presentations`,parameters:{conference:`Conference, all by default, can be found in URL`},description:"::: tip\n  If you subscribe to [InfoQ Live Jan 2024](https://www.infoq.com/infoq-live-jan-2024/presentations/)ï¼Œwhere the URL is `https://www.infoq.com/infoq-live-jan-2024/presentations/`, extract the part `https://www.infoq.com/` to the end, which is `/presentations/`, and use it as the parameter to fill in. Therefore, the route will be [`/infoq/presentations/infoq-live-jan-2024`](https://rsshub.app/infoq/presentations/infoq-live-jan-2024).\n:::\n    ",categories:[`programming`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`www.infoq.com/presentations`,`www.infoq.com/:conference/presentations`],target:e=>{let t=e.conference;return`/presentations${t?`/${t}`:``}`}}]};export{s as handler,c as route};