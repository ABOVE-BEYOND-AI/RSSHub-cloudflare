import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import"./helpers-LVq640iW.js";import{cache_default as e}from"./cache-C3AIQtoX.js";import{art as t}from"./render-DE4LRFBD.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import"./ofetch-DRl42yaJ.js";import{__dirname as r}from"./esm-shims-BDPl6Msv.js";import{got_default as i}from"./got-BaOFZRd4.js";import{timezone as a}from"./timezone-BrxBCotj.js";import o from"node:path";import{load as s}from"cheerio";const c=e=>e.map(e=>{let t=e.type;return t===`video`?l(e.data):t===`text`?e.data.replaceAll(/data-lazyload=(.+?) src=(.+?) style=".+?"/g,`src=$1`):``}).join(`<br>`),l=e=>t(o.join(r,`templates/video-e05cff83.art`),{videoInfo:e}),u={path:`/feng/:id/:type`,categories:[`new-media`],example:`/ifeng/feng/2583/doc`,parameters:{id:`对应 id，可在 大风号作者页面 找到`,type:`类型，见下表`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`大风号`,maintainers:[`Jamch`],handler:d,description:`| 文章 | 视频  |
| ---- | ----- |
| doc  | video |`};async function d(t){let{id:r,type:o}=t.req.param(),{data:u}=await i(`https://ishare.ifeng.com/mediaShare/home/${r}/media`,{headers:{Referer:`https://feng.ifeng.com/author/${r}`}}),{data:d}=await i(`https://shankapi.ifeng.com/season/ishare/getShareListData/${r}/${o}/1/ifengnewsh5/getListData`,{headers:{Referer:`https://feng.ifeng.com/author/${r}`}}),f=s(u),{sockpuppetInfo:p}=JSON.parse(f(`script`).text().match(/var allData = (.*?);/)[1]),{data:m}=JSON.parse(d.match(/getListData\((.*)\)/)[1]),{weMediaName:h,honorDesc:g,description:_,logo:v}=p,y=m.map(e=>({title:e.title,pubDate:a(n(e.newsTime),8),author:h,link:`https:${e.url}`})),b=await Promise.all(y.map(t=>e.tryGet(t.link,async()=>{let{data:e}=await i(t.link),n=s(e),r=JSON.parse(n(`script`).text().match(/var allData = ({.*?});/)[1]);return o===`doc`&&(t.description=c(r.docData.contentData.contentList)),o===`video`&&(t.description=l(r.videoInfo)),t.category=r.keywords.split(`,`),t.author=r.docData?.editorName??t.author,t})));return{title:`大风号-${h}-${o===`doc`?`文章`:`视频`}`,description:`${g} ${_}`,image:`https:${v}`,link:`https://ishare.ifeng.com/mediaShare/home/${r}/media`,item:b}}export{u as route};