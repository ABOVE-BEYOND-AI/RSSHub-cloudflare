import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import{cache_default as e}from"./cache-C3AIQtoX.js";import{art as t}from"./render-DE4LRFBD.js";import{ofetch_default as n}from"./ofetch-DRl42yaJ.js";import{__dirname as r}from"./esm-shims-BDPl6Msv.js";import i from"node:path";import*as a from"cheerio";const o=e=>t(i.join(r,`templates/media-554156ec.art`),{video:{cover:e.posterImages?.full?.href||e.posterImages?.default?.href,src:e.links?.source.mezzanine?.href||e.links?.source.HD?.href||e.links?.source.full?.href||e.links?.source.href,title:e.title,description:e.description},image:{src:e.url,alt:e.alt,caption:e.caption,credit:e.credit}}),s=/inline\d+|alsosee/,c=/(photo|video)(\d+)/,l={path:`/news/:sport`,name:`News`,maintainers:[`weijianduan0302`],example:`/espn/news/nba`,categories:[`traditional-media`],parameters:{sport:`sport category, can be nba, nfl, mlb, nhl etc.`},description:`Get the news feed of the sport you love on ESPN.
| Sport                |  sport  |  Sport         |  sport  |
|----------------------|---------|----------------|---------|
| 🏀 NBA                | nba     | 🎾 Tennis       | tennis  |
| 🏀 WNBA               | wnba    | ⛳️ Golf         | golf    |
| 🏈 NFL                | nfl     | 🏏 Cricket      | cricket |
| ⚾️ MLB                | mlb     | ⚽️ Soccer       | soccer  |
| 🏒 NHL                | nhl     | 🏎️ F1           | f1      |
| ⛹️ College Basketball | ncb      | 🥊 MMA          | mma     |
| 🏟️️ College Football   | ncf     | 🏈 UFL          | ufl     |
| 🏉 Rugby              | rugby   | 🃏 Poker        | poker   |`,radar:[{source:[`espn.com/:sport*`],target:`/news/:sport`}],handler:async t=>{let{sport:r=`nba`}=t.req.param(),i=await n(`https://onefeed.fan.api.espn.com/apis/v3/cached/contentEngine/oneFeed/leagues/${r}?offset=0`,{headers:{accept:`application/json`}}),l=new Set([`HeadlineNews`,`Story`,`Media`,`Shortstop`]),u=i.feed.filter(e=>l.has(e.data.now[0].type)).map(e=>{let t=e.data.now[0],n=t.type;return{title:t.headline,link:t.links.web.href,author:t.byline,pubDate:e.date,description:n===`Media`?o(t.video[0]):n===`Shortstop`?t.headline:``}}),d=await Promise.all(u.map(t=>e.tryGet(t.link,async()=>{if(t.description===``){let e=await n(`${t.link}?xhr=1`,{headers:{accept:`application/json`}}),r=a.load(e.content.story,null,!1);r(`*`).each((t,n)=>{if(s.test(n.name)&&r(n).remove(),c.test(n.name)){let t=n.name.match(c)[1]===`photo`?`images`:`video`,i=Number.parseInt(n.name.match(c)[2])-1,a=e.content[t][i];a?r(n).replaceWith(o(a)):r(n).remove()}}),t.description=r.html()}return t})));return{title:`ESPN ${r.toUpperCase()} News`,link:`https://www.espn.com/espn/rss/${r}/news`,item:d}}};export{l as route};