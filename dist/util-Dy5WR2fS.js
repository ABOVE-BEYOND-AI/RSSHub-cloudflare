import{art as e}from"./render-DE4LRFBD.js";import{parseDate as t}from"./parse-date-DHsdom8D.js";import{__dirname as n}from"./esm-shims-BDPl6Msv.js";import{got_default as r}from"./got-BaOFZRd4.js";import i from"node:path";import{load as a}from"cheerio";const o=`xinpianchang.com`,s=`https://www.${o}`,c=`https://mod-api.${o}`,l=(e,t)=>t(e,async()=>{let{data:t}=await r(e),n=a(t),i=new URL(`favicon.ico`,s).href,o=n(`meta[property="og:site_name"]`).prop(`content`);return{data:{title:n(`span.bg-clip-text`).text()||`${o}Â·${n(`meta[property="og:title"]`).prop(`content`).split(`-`)[0]}`,link:e,description:n(`meta[property="og:description"]`).prop(`content`),language:n(`html`).prop(`lang`),image:n(`meta[property="og:image"]`).prop(`content`),icon:i,logo:i,subtitle:n(`meta[property="og:description"]`).prop(`content`),author:o,itunes_author:o,itunes_category:`TV &amp Film`,allowEmpty:!0},response:t}}),u=async(a,o)=>(a=a.map(e=>({title:e.title,link:e.web_url,description:e.content,author:e.author.userinfo.username,category:e.categories.flatMap(e=>[e.category_name,e.sub?.category_name]).filter(Boolean),guid:`xinpianchang-${e.id}`,pubDate:t(e.publish_time*1e3),itunes_item_image:e.cover,itunes_duration:e.duration,enclosure_url:e.video_library_id,upvotes:e.count.count_liked??e.count.count_like,comments:e.count.count_comment??0})),await Promise.all(a.map(t=>o(t.guid,async()=>{let a=new URL(`mod/api/v2/media/${t.enclosure_url}?appKey=61a2f329348b3bf77`,c).href,{data:o}=await r(a),s=o.data,l=s.resource?.progressive?s.resource.progressive[0]:void 0;return t.title=s.title??t.title,t.description=e(i.join(n,`templates/description-f6d7881b.art`),{content:t.description,cover:s.cover??t.itunes_item_image,enclousure:l}),t.author=s.owner.username??t.author,t.category=[...new Set([...t.category,...s.categories??[],...s.keywords??[]])],t.itunes_item_image=s.cover??t.itunes_item_image,t.itunes_duration=s.duration??t.itunes_duration,l&&(t.enclosure_url=l.url??l.backupUrl,t.enclosure_length=l.filesize,t.enclosure_type=l.mime),t}))));export{l as getData,u as processItems,s as rootUrl};