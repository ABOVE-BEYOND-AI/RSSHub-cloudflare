import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import{cache_default as e}from"./cache-C3AIQtoX.js";import{art as t}from"./render-DE4LRFBD.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import{ofetch_default as r}from"./ofetch-DRl42yaJ.js";import{__dirname as i}from"./esm-shims-BDPl6Msv.js";import{ViewType as a}from"./types-D9T3SQ-7.js";import o from"node:path";import{load as s}from"cheerio";const c=async a=>{let{category:c=`news`}=a.req.param(),l=Number.parseInt(a.req.query(`limit`)??`7`,10),u=`http://www.ccg.org.cn`,d=new URL(c,u).href,f=await r(d),p=s(f),m=p(`html`).attr(`lang`)??`zh`,h=[];h=p(`ul.huodong-list li`).slice(0,l).toArray().map(e=>{let r=p(e),a=r.find(`h5`).text(),s=r.find(`div.huodong-img img`).attr(`src`),c=t(o.join(i,`templates/description-881baa33.art`),{images:s?[{src:s,alt:a}]:void 0,intro:r.find(`p`).html()}),l=r.find(`span`).text(),u=r.find(`a`).attr(`href`),d=l,f={title:a,description:c,pubDate:l?n(l,`YYYY年M月D日`):void 0,link:u,content:{html:c,text:c},image:s,banner:s,updated:d?n(d,`YYYY年M月D日`):void 0,language:m};return f}),h=await Promise.all(h.map(a=>a.link?e.tryGet(a.link,async()=>{let e=await r(a.link),c=s(e),l=c(`div.pinpai-page h3`).text(),u=c(`span.time`).text();c(`div.pinpai-page h3`).remove(),c(`div.pinpai-page span.time`).remove();let d=t(o.join(i,`templates/description-881baa33.art`),{description:c(`div.pinpai-page`).html()}),f=u,p={title:l,description:d,pubDate:u?n(u,`YYYY年M月D日`):a.pubDate,content:{html:d,text:d},updated:f?n(f,`YYYY年M月D日`):a.updated,language:m};return{...a,...p}}):a));let g=p(`h1.nav-logo`).first().text();return{title:`${g} - ${p(`title`).text()}`,link:d,item:h,allowEmpty:!0,image:new URL(`wp-content/themes/ccg/imgs/nav-logo.png`,u).href,author:g,language:m,id:d}},l={path:`/:category?`,name:`动态`,url:`www.ccg.org.cn`,maintainers:[`nczitzk`],handler:c,example:`/ccg/news`,parameters:{category:{description:"分类，默认为 `news`，即新闻动态，可在对应分类页 URL 中找到",options:[{label:`新闻动态`,value:`news`},{label:`媒体报道`,value:`mtbd`}]}},description:`:::tip
订阅 [新闻动态](http://www.ccg.org.cn/news)，其源网址为 \`http://www.ccg.org.cn/news\`，请参考该 URL 指定部分构成参数，此时路由为 [\`/ccg/news\`](https://rsshub.app/ccg/news)。
:::

| 分类                                   | ID                                  |
| -------------------------------------- | ----------------------------------- |
| [新闻动态](http://www.ccg.org.cn/news) | [news](https://rsshub.app/ccg/news) |
| [媒体报道](http://www.ccg.org.cn/mtbd) | [mtbd](https://rsshub.app/ccg/mtbd) |
`,categories:[`new-media`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`www.ccg.org.cn/category`],target:`/:category`},{title:`新闻动态`,source:[`www.ccg.org.cn/news`],target:`/news`},{title:`媒体报道`,source:[`www.ccg.org.cn/mtbd`],target:`/mtbd`}],view:a.Articles};export{c as handler,l as route};