import{config as e}from"./config-HRWLmo66.js";import{cache_default as t}from"./cache-C3AIQtoX.js";import{art as n}from"./render-DE4LRFBD.js";import{parseDate as r}from"./parse-date-DHsdom8D.js";import{ofetch_default as i}from"./ofetch-DRl42yaJ.js";import{__dirname as a}from"./esm-shims-BDPl6Msv.js";import o from"node:path";import{load as s}from"cheerio";const c=()=>t.tryGet(`aeon:buildId`,async()=>{let e=await i(`https://aeon.co`),t=s(e),n=JSON.parse(t(`script#__NEXT_DATA__`).text());return n.buildId},e.cache.routeExpire,!1),l=async e=>{let l=await Promise.all(e.map(e=>t.tryGet(e.link,async()=>{let t=await c(),l=await i(`https://aeon.co/_next/data/${t}/${e.type}s/${e.slug}.json?id=${e.slug}`),u=l.pageProps.article,d=u.type.toLowerCase();if(e.pubDate=r(u.publishedAt),d===`video`)e.description=n(o.join(a,`templates/video-f69decfd.art`),{article:u});else{if(u.audio?.id){let t=await i(`https://api.aeonmedia.co/graphql`,{method:`POST`,body:{query:`query getAudio($audioId: ID!) {
                                    audio(id: $audioId) {
                                        id
                                        streamUrl
                                    }
                                }`,variables:{audioId:u.audio.id},operationName:`getAudio`}});delete e.image,e.enclosure_url=t.data.audio.streamUrl,e.enclosure_type=`audio/mpeg`}let t=s(u.body,null,!1),r=u.image;t(`p.pullquote`).remove();let c=u.authors.map(e=>`<p>`+e.name+e.authorBio.replaceAll(/^<p>/g,` `)).join(``);e.description=n(o.join(a,`templates/essay-deb2bd55.art`),{banner:r,authorsBio:c,content:t.html()})}return e})));return l};export{c as getBuildId,l as getData};