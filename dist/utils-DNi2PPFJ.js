import{cache_default as e}from"./cache-C3AIQtoX.js";import{art as t}from"./render-DE4LRFBD.js";import{parseDate as n,parseRelativeDate as r}from"./parse-date-DHsdom8D.js";import{__dirname as i}from"./esm-shims-BDPl6Msv.js";import{got_default as a}from"./got-BaOFZRd4.js";import o from"node:path";import{load as s}from"cheerio";const c=e=>({title:e.name,link:e.link,description:e.name,pubDate:n(e.pubTimeLong),media:{content:{url:e.pic}}});var l={ProcessItem:(l,u)=>{let d=u.req.query(`old`)===`yes`;if(l.link)return c(l);let f=`https://m.thepaper.cn/${l.cornerLabelDesc&&l.cornerLabelDesc===`短剧`?`series`:`detail`}/${l.contId}`;return e.tryGet(`${f}${d?`:old`:``}`,async()=>{let e=await a(f),u=JSON.parse(s(e.data)(`#__NEXT_DATA__`).html()),p=u.props.pageProps.detailData,m=p.contentDetail||p.liveDetail||p.specialDetail?.specialInfo;if(!m)return c(l);let h=m.content||m.summary||m.desc||``;m.videos&&(h+=m.summary),d&&(m.videos&&(h=t(o.join(i,`templates/video_detail-6e02b70e.art`),{videos:m.videos})+h),m.images&&(h=t(o.join(i,`templates/image_detail-7a807b2d.art`),{images:m.images})+h));let g=n(l.pubTimeLong||m.publishTime);Number.isNaN(g)&&(g=r(m.pubTime));let _={title:m.name||m.shareName,link:f,description:h,category:[...m.tagList?.map(e=>e.tag)??[],m?.nodeInfo?.name??[]],pubDate:g,author:m.author||``,media:{content:{url:l.pic||m.videos?.coverUrl||m.bigPic},thumbnails:{url:l.sharePic||m.sharePic}}};return m.voiceInfo?.isHaveVoice&&(_.enclosure_type=`audio/mpeg`,_.enclosure_url=m.voiceInfo.voiceSrc,_.itunes_item_image=l.pic||m.videos?.coverUrl),_})},ChannelIdToName:(e,t)=>t.props.appProps.menu.channelList.find(t=>t.nodeId.toString()===e.toString()).name,ListIdToName:(e,t)=>t.props.appProps.menu.channelList.flatMap(e=>e.childNodeList||[]).find(t=>t.nodeId.toString()===e.toString())?.name,ExtractLogo:e=>`https://m.thepaper.cn`+s(e.data)(`img.imageCover`).attr(`src`)};export{l as utils_default};