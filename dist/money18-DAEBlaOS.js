import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import"./helpers-LVq640iW.js";import{cache_default as e}from"./cache-C3AIQtoX.js";import{art as t}from"./render-DE4LRFBD.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import"./ofetch-DRl42yaJ.js";import{__dirname as r}from"./esm-shims-BDPl6Msv.js";import{got_default as i}from"./got-BaOFZRd4.js";import{timezone as a}from"./timezone-BrxBCotj.js";import o from"node:path";import s from"dayjs";import{load as c}from"cheerio";const l={exp:`新聞總覽`,fov:`全日焦點`,industry:`板塊新聞`,int:`國際金融`,recagent:`大行報告`,ntlgroup:`A股新聞`,pro:`地產新聞`,weainvest:`投資理財`,ipo:`新股IPO`,tech:`科技財情`},u={path:`/money18/:id?`,categories:[`traditional-media`],example:`/oncc/money18/exp`,parameters:{id:`栏目 id，可在对应栏目页 URL 中找到，默认为 exp，即新聞總覽`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`Money18`,maintainers:[`nczitzk`],handler:d,description:`| 新聞總覽 | 全日焦點 | 板塊新聞 | 國際金融 | 大行報告 | A 股新聞 | 地產新聞 | 投資理財  | 新股 IPO | 科技財情 |
| -------- | -------- | -------- | -------- | -------- | -------- | -------- | --------- | -------- | -------- |
| exp      | fov      | industry | int      | recagent | ntlgroup | pro      | weainvest | ipo      | tech     |`};async function d(u){let d=u.req.param(`id`)??`exp`,f=u.req.query(`limit`)?Number.parseInt(u.req.query(`limit`)):30,p=`https://money18.on.cc`,m=`${p}/finnews/news_${d===`industry`?`industry.html`:`breaking.html?section=${d}`}`,h=`https://dyn.on.cc/api/asrh/v1/events/names/新股/articles?page=1&limit=${f}`,g=`${p}/cnt/utf8/content/articleList/sector_list_exp_1.js`,_=e=>`${p}/cnt/utf8/content/${e}/articleList/list_${d}_all.js`,v=d===`ipo`?h:d===`industry`?g:_(s().format(`YYYYMMDD`)),y=!1,b=[],x=0,S;for(;!y;)try{S=await i({method:`get`,url:v}),y=!0}catch(e){e.code===`ERR_NON_2XX_3XX_RESPONSE`&&(y=!1,v=_(s().subtract(++x,`day`).format(`YYYYMMDD`)))}return b=d===`ipo`?S.data.articles.map(e=>({title:e.title,author:e.authorname,link:`${p}/finnews/content/${d}/${e.articleId}.html`,description:t(o.join(r,`templates/money18-3f53584c.art`),{images:e.hasHdPhoto?[`https://hk.on.cc/hk/bkn${e.hdEnlargeThumbnail}`]:void 0,description:e.content}),pubDate:a(n(e.pubDate),8)})):d===`industry`?S.data.articles.slice(0,f).map(e=>({title:e.title,author:e.authorname,link:`${p}/finnews/content/${d}/${e.articleId}.html`,category:e.sector.map(e=>e.name),pubDate:a(n(e.pubDate),8)})):S.data.slice(0,f).map(e=>({title:e.title,author:e.authorname,link:`${p}/finnews/content/${d}/${e.articleId}.html`,pubDate:a(n(e.pubDate),8)})),d!==`ipo`&&(b=await Promise.all(b.map(n=>e.tryGet(n.link,async()=>{let e=await i({method:`get`,url:n.link}),a=c(e.data);return n.description=t(o.join(r,`templates/money18-3f53584c.art`),{images:a(`.photo img`).toArray().map(e=>a(e).attr(`src`)),description:a(`.content`).html()}),n})))),{title:`東網產經 - ${l[d]}`,link:m,item:b}}export{u as route};