import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import"./helpers-LVq640iW.js";import{cache_default as e}from"./cache-C3AIQtoX.js";import{art as t}from"./render-DE4LRFBD.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import"./ofetch-DRl42yaJ.js";import{__dirname as r}from"./esm-shims-BDPl6Msv.js";import{got_default as i}from"./got-BaOFZRd4.js";import a from"node:path";import{load as o}from"cheerio";const s={path:`/:bookName/book-series/:bookId`,radar:[{source:[`routledge.com/:bookName/book-series/:bookId`]}],name:`Unknown`,maintainers:[`TonyRL`],handler:c};async function c(s){let{bookName:c,bookId:l}=s.req.param(),u=`https://www.routledge.com/${c}/book-series/${l}`,{data:d}=await i(u,{headers:{accept:`text/html, */*; q=0.01`},searchParams:{publishedFilter:`alltitles`,pd:`published,forthcoming`,pg:1,pp:12,so:`pub`,view:`list`}}),f=o(d),p=f(`.row.book`).toArray().map(e=>{e=f(e);let t=e.find(`h3 a`),r=e.find(`p.description`),i=e.find(`p.description`).prev().text().split(`
`);return{title:t.text(),link:t.attr(`href`),description:r.text(),pubDate:n(i.pop().trim(),`MMMM DD, YYYY`),author:i.map(e=>e.trim()).filter(Boolean).join(`, `)}}),m=await Promise.all(p.map(n=>e.tryGet(n.link,async()=>{let{data:e}=await i(n.link),s=o(e),c=s(`meta[property="books:isbn"]`).attr(`content`),{data:l}=await i(`https://productimages.routledge.com`,{searchParams:{isbn:c,size:`amazon`,ext:`jpg`}}),u=s(`.sticky-div`);return u.find(`button.accordion-button`).contents().unwrap(),u.find(`.fa-shopping-cart`).parent().parent().remove(),n.description=t(a.join(r,`templates/description-c2244266.art`),{image:l,description:u.html()}),n})));return{title:f(`head title`).text(),description:f(`head meta[name="description"]`).attr(`content`),link:u,item:m}}export{s as route};