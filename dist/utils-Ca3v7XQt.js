import{config as e}from"./config-HRWLmo66.js";import{cache_default as t}from"./cache-C3AIQtoX.js";import{art as n}from"./render-DE4LRFBD.js";import{parseDate as r}from"./parse-date-DHsdom8D.js";import{md5 as i}from"./md5-15Cn4YyR.js";import{__dirname as a}from"./esm-shims-BDPl6Msv.js";import{got_default as o}from"./got-BaOFZRd4.js";import{config_not_found_default as s}from"./config-not-found-B7nOMdXp.js";import c from"node:path";import{load as l}from"cheerio";import u from"crypto-js";const d=`jmcomic1.me`,f=new Set([`18comic.vip`,`18comic.org`,`jmcomic.me`,`jmcomic1.me`,`jm-comic3.art`,`jm-comic.club`,`jm-comic2.ark`]),p=t=>{if(!e.feature.allow_user_supply_unsafe_domain&&!f.has(t))throw new s(`This RSS is disabled unless 'ALLOW_USER_SUPPLY_UNSAFE_DOMAIN' is set to 'true'.`);return`https://${t}`},m=e=>{switch(e){case`another`:return`其他漫畫`;case`doujin`:return`同人`;case`hanman`:return`韓漫`;case`meiman`:return`美漫`;case`short`:return`短篇`;case`single`:return`單本`;default:return null}},h=()=>`https://www.cdnblackmyth.club`,g=async e=>{e=e.replace(/\?$/,``);let t=Date.now(),n=`${t},1.7.5`,r=`${t}18comicAPP`;r=i(r);let a=await o(e,{headers:{token:r,tokenparam:n}}),s=u.enc.Base64.parse(a.data.data),c=u.MD5(t+`185Hcomic3PAPP7R`).toString(),l=u.enc.Utf8.parse(c),d=u.lib.CipherParams.create({ciphertext:s}),f=u.AES.decrypt(d,l,{mode:u.mode.ECB,padding:u.pad.Pkcs7}),p=f.toString(u.enc.Utf8),m=JSON.parse(p);return m},_=async(e,i,s)=>{i=i.replace(/\?$/,``);let u=await o(i),d=l(u.data),f=d(`.video-title`).slice(0,e.req.query(`limit`)?Number.parseInt(e.req.query(`limit`)):20).toArray().map(e=>(e=d(e),{title:e.text().trim(),link:`${s}${e.prev().find(`a`).attr(`href`)}`,guid:`18comic:${e.prev().find(`a`).attr(`href`)}`}));return f=await Promise.all(f.map(e=>t.tryGet(e.guid,async()=>{let t=await o(e.link),i=l(t.data);return e.pubDate=r(i(`div[itemprop="datePublished"]`).first().attr(`content`)),e.updated=r(i(`div[itemprop="datePublished"]`).last().attr(`content`)),e.category=i(`span[data-type="tags"]`).first().find(`a`).toArray().map(e=>d(e).text()),e.author=i(`span[data-type="author"]`).first().find(`a`).toArray().map(e=>d(e).text()).join(`, `),e.description=n(c.join(a,`templates/description-afe7e434.art`),{introduction:i(`#intro-block .p-t-5`).text(),images:i(`.img_zoom_img img`).toArray().map(e=>i(e).attr(`data-original`)),cover:i(`.thumb-overlay img`).first().attr(`src`),category:e.category}),e}))),{title:d(`title`).text(),link:i,item:f,description:d(`meta[property="og:description"]`).attr(`content`),allowEmpty:!0}};export{_ as ProcessItems,m as apiMapCategory,d as defaultDomain,h as getApiUrl,p as getRootUrl,g as processApiItems};