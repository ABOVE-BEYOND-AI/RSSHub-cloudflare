import{cache_default as e}from"./cache-C3AIQtoX.js";import{art as t}from"./render-DE4LRFBD.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import{ofetch_default as r}from"./ofetch-DRl42yaJ.js";import{__dirname as i}from"./esm-shims-BDPl6Msv.js";import a from"node:path";import{load as o}from"cheerio";const s=`https://www.dcfever.com`,c=t=>e.tryGet(t.link,async()=>{let e=await r(t.link),i=o(e),a=i(`div[itemprop="articleBody"], .column_article_content_html`),s=i(`.article_multi_page a`).not(`.selected`).toArray().map(e=>({link:new URL(i(e).attr(`href`),t.link).href}));if(s.length){let e=await Promise.all(s.map(async e=>{let t=await r(e.link),n=o(t);return n(`div[itemprop="articleBody"]`).html()}));a.append(e)}return a.find(`img`).each((e,t)=>{t.attribs.src?.includes(`?`)&&(t.attribs.src=t.attribs.src.split(`?`)[0])}),a.find(`p a`).each((e,t)=>{t=i(t),t.text().startsWith(`下一頁為`)&&t.remove()}),a.find(`iframe`).each((e,t)=>{t=i(t),t.attr(`src`).startsWith(`https://www.facebook.com/plugins/like.php`)&&t.remove()}),t.description=a.html(),t.pubDate=n(i(`meta[property="article:published_time"]`).attr(`content`)),t}),l=n=>e.tryGet(n.link,async()=>{let e=await r(n.link),s=o(e),c=s(`#trading_item_section .description`).contents().filter((e,t)=>t.type===`comment`).toArray().map(e=>e.data).join(``),l=o(c,null,!1);return l(`.selector_text`).remove(),l(`.selector_image_div`).each((e,t)=>{delete t.attribs.onclick}),l(`.desktop_photo_selector img`).each((e,t)=>{t.attribs.src.endsWith(`_sqt.jpg`)&&(t.attribs.src=t.attribs.src.replace(`_sqt.jpg`,`.jpg`))}),n.description=t(a.join(i,`templates/trading-949c0be3.art`),{info:s(`.info_col`),description:s(`.description_text`).html(),photo:l(`.desktop_photo_selector`).html()}),n});export{s as baseUrl,c as parseItem,l as parseTradeItem};