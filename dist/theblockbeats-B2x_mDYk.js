import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import{cache_default as e}from"./cache-C3AIQtoX.js";import{art as t}from"./render-DE4LRFBD.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import{ofetch_default as r}from"./ofetch-DRl42yaJ.js";import{__dirname as i}from"./esm-shims-BDPl6Msv.js";import{ViewType as a}from"./types-D9T3SQ-7.js";import o from"node:path";import{load as s}from"cheerio";const c=`https://www.theblockbeats.info`,l=`https://api.blockbeats.cn`,u=e=>{let n=t(o.join(i,`templates/description-ee3da0fe.art`),e),r=s(n,null,!1);return r(`img`).each((e,t)=>{let n=r(t),i=n.attr(`src`);n.attr(`src`,i?.split(`?`)[0])}),r.html()},d={newsflash:{title:`快讯`,link:`${c}/newsflash`,api:`${l}/v2/newsflash/list`},article:{title:`文章`,link:`${c}/article`,api:`${l}/v2/article/list`}},f={path:`/:channel?/:original?`,categories:[`finance`],view:a.Articles,example:`/theblockbeats/newsflash`,parameters:{channel:{description:`类型`,options:[{value:`newsflash`,label:`快讯`},{value:`article`,label:`文章`}],default:`newsflash`},original:{description:"文章类型，仅 `channel` 为 `article` 时有效",options:[{value:`0`,label:`全部`},{value:`1`,label:`深度`},{value:`2`,label:`精选`},{value:`3`,label:`热点追踪`}],default:`0`}},name:`新闻快讯`,maintainers:[`Fatpandac`,`jameshih`,`DIYgod`],handler:p,radar:[{title:`文章`,source:[`www.theblockbeats.info/article`],target:`/article`},{title:`快讯`,source:[`www.theblockbeats.info/newsflash`],target:`/newsflash`}],description:`|    快讯   |   文章  |
| :-------: | :-----: |
| newsflash | article |

| 全部 | 深度 | 精选 | 热点追踪 |
| :--: | :--: | :--: | :---: |
|     | -2  | 1    |  2     |`};async function p(t){let{channel:i=`newsflash`,original:a}=t.req.param(),o=await r(d[i].api,{query:{limit:t.req.query(`limit`)?Number.parseInt(t.req.query(`limit`)):20,original:i===`article`?a:void 0}}),l=o.data.list.map(e=>({title:e.title,link:`${c}/${i===`newsflash`?`flash`:`news`}/${e.article_id}`,description:e.content??e.abstract,pubDate:n(e.add_time,`X`),author:e.author?.nickname,category:e.tag_list,imgUrl:e.img_url}));return i!==`newsflash`&&(l=await Promise.all(l.map(t=>e.tryGet(`theblockbeats:${t.link}`,async()=>{let e=await r(t.link),n=s(e);return t.description=u({image:t.imgUrl,description:n(`div.news-content`).html()}),t})))),{title:`TheBlockBeats - ${d[i].title}`,link:d[i].link,item:l}}export{f as route};