import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import"./helpers-LVq640iW.js";import{cache_default as e}from"./cache-C3AIQtoX.js";import{art as t}from"./render-DE4LRFBD.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import"./ofetch-DRl42yaJ.js";import{__dirname as r}from"./esm-shims-BDPl6Msv.js";import{got_default as i}from"./got-BaOFZRd4.js";import{ViewType as a}from"./types-D9T3SQ-7.js";import o from"node:path";import{load as s}from"cheerio";const c={path:`/books/:language`,categories:[`design`],view:a.Articles,example:`/jimmyspa/books/tw`,parameters:{language:{description:`语言`,options:[{value:`tw`,label:`臺灣正體`},{value:`en`,label:`English`},{value:`jp`,label:`日本語`}]}},radar:[{source:[`www.jimmyspa.com/:language/Books`]}],name:`Books`,description:`
| language | Description |
| ---   | ---   |
| tw | 臺灣正體 |
| en | English |
| jp | 日本語 |
    `,maintainers:[`Cedaric`],handler:l};async function l(a){let c=a.req.param(`language`),l=`https://www.jimmyspa.com`,u=new URL(`/${c}/Books/Ajax/changeList?year=&keyword=&categoryId=0&page=1`,l).href,d=await i(u),f=s(d.data.view),p=f(`ul#appendWork li.work_block`).toArray().map(async a=>{let c=s(a),u=c(`p.tit`).text(),d=c(`div.work_img img`).prop(`src`)||``,f=d?l+d:``,p=c(`li.work_block`).prop(`data-route`),{renderedDescription:m,publishDate:h}=await e.tryGet(p,async()=>{let e=await i(p),a=s(e.data),c=a(`article.intro_cont`).html()||``,d=a(`div.info_wrap`).html()||``,m=c.replaceAll(/<img\b[^>]*>/g,e=>e.replaceAll(/\b(src|data-src)="(?!http|https|\/\/)([^"]*)"/g,(e,t,n)=>{let r=new URL(n,l).href;return`${t}="${r}"`})),h=d.match(/<span>(首次出版|First Published|初版)<\/span>\s*<span class="num">([^<]+)<\/span>/),g=h?n(h[2]+`-02`):``,_=t(o.join(r,`templates/description-16be3a2a.art`),{images:f?[{src:f,alt:u}]:void 0,description:m});return{renderedDescription:_,publishDate:g}});return{title:u,link:p,description:m,pubDate:h,content:{html:m,text:u}}});return{title:`幾米 - 幾米創作(${c})`,link:`${l}/${c}/Books`,allowEmpty:!0,item:await Promise.all(p)}}export{c as route};