import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import{cache_default as e}from"./cache-C3AIQtoX.js";import{art as t}from"./render-DE4LRFBD.js";import"./parse-date-DHsdom8D.js";import{getSubPath as n}from"./common-utils-C27Jp3s6.js";import{ofetch_default as r}from"./ofetch-DRl42yaJ.js";import{__dirname as i}from"./esm-shims-BDPl6Msv.js";import a from"node:path";import{load as o}from"cheerio";const s={arabic:{rootUrl:`https://www.aljazeera.net`,rssUrl:`rss`},chinese:{rootUrl:`https://chinese.aljazeera.net`,rssUrl:void 0},english:{rootUrl:`https://www.aljazeera.com`,rssUrl:`xml/rss/all.xml`}},c={path:`*`,name:`Unknown`,maintainers:[`nczitzk`],handler:l};async function l(c){let l=n(c)===`/`?[`arabic`]:n(c).replace(/^\//,``).split(`/`);Object.hasOwn(s,l[0])||l.unshift(`arabic`);let u=l.shift(),d=l.length===1&&l.at(-1)===`rss`&&s[u].rssUrl,f=s[u].rootUrl,p=`${f}/${d?s[u].rssUrl:l.join(`/`)}`,m=await r(p),h=o(m),g=d?m.data.match(RegExp(`<link>`+f+`/(.*?)</link>`,`g`)).map(e=>({link:e.match(/<link>(.*?)<\/link>/)[1]})):h(`.u-clickable-card__link`).toArray().map(e=>(e=h(e),{link:`${f}${e.attr(`href`)}`}));return g=await Promise.all(g.slice(0,c.req.query(`limit`)?Number.parseInt(c.req.query(`limit`)):50).map(n=>e.tryGet(n.link,async()=>{let e=await r(n.link),s=o(e);s(`.more-on`).parent().remove(),s(`.responsive-image img`).removeAttr(`srcset`);let c,l=e.match(/"datePublished": ?"(.*?)",/);if(l&&l.length>1)c=e.match(/"datePublished": ?"(.*?)",/)[1];else{let t=e.match(/"uploadDate": ?"(.*?)",/)[1];c=t&&t.length>1?t:s(`div.date-simple > span:nth-child(2)`).text()}return n.title=s(`h1`).first().text(),n.author=s(`.author`).text(),n.pubDate=c,n.description=t(a.join(i,`templates/description-96c51509.art`),{image:s(`.article-featured-image`).html(),description:s(`.wysiwyg`).html()}),n}))),{title:h(`title`).first().text(),link:p,item:g}}export{c as route};