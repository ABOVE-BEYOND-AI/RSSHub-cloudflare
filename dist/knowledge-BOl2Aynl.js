import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import"./helpers-LVq640iW.js";import{art as e}from"./render-DE4LRFBD.js";import{parseDate as t}from"./parse-date-DHsdom8D.js";import"./ofetch-DRl42yaJ.js";import{__dirname as n}from"./esm-shims-BDPl6Msv.js";import{got_default as r}from"./got-BaOFZRd4.js";import i from"node:path";const a={path:`/knowledge/:topic?/:type?`,categories:[`new-media`],example:`/dedao/knowledge`,parameters:{topic:`话题 id，可在对应话题页 URL 中找到`,type:"分享类型，`true` 指精选，`false` 指最新，默认为精选"},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`dedao.cn/knowledge/topic/:topic`,`dedao.cn/knowledge`,`dedao.cn/`]}],name:`知识城邦`,maintainers:[`nczitzk`],handler:o};async function o(a){let o=a.req.param(`topic`)??``,s=/t|y/i.test(a.req.param(`type`)??`true`),c=a.req.query(`limit`)?Number.parseInt(a.req.query(`limit`)):100,l=`https://www.dedao.cn`,u=`${l}/knowledge${o===``?``:`/topic/`+o}`,d=`${l}/pc/ledgers/${o===``?`notes/friends_timeline`:`topic/notes/list`}`,f=`${l}/pc/ledgers/topic/detail`,p=``,m=``;if(o!==``){let e=await r({method:`post`,url:f,json:{incr_view_count:!1,topic_id_hazy:o}});p=e.data.c.name,m=e.data.c.intro}let h=await r({method:`post`,url:d,json:{count:c,load_chain:!0,is_elected:s,page_id:0,topic_id_hazy:o,version:2}}),g=(o===``?h.data.c.notes:h.data.c.note_detail_list).map(r=>({title:r.f_part.note,author:r.f_part.nick_name,link:`${l}/knowledge/note/${r.f_part.note_id_hazy}`,pubDate:t(r.f_part.time_desc,`MM-DD`),description:e(i.join(n,`templates/knowledge-72d39b85.art`),{rootUrl:l,f_part:r.f_part,s_part:r.s_part})}));return{title:`得到 - 知识城邦${p===``?``:` - `+p}`,link:u,item:g,description:m}}export{a as route};