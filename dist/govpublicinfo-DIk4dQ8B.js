import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import"./helpers-LVq640iW.js";import{cache_default as e}from"./cache-C3AIQtoX.js";import{art as t}from"./render-DE4LRFBD.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import"./ofetch-DRl42yaJ.js";import{__dirname as r}from"./esm-shims-BDPl6Msv.js";import{got_default as i}from"./got-BaOFZRd4.js";import{timezone as a}from"./timezone-BrxBCotj.js";import o from"node:path";import{load as s}from"cheerio";const c={绵竹市:{rootUrl:`https://www.mz.gov.cn`,infoType:{fdzdnr:{basicUrl:`https://www.mz.gov.cn/info/iList.jsp?node_id=GKmzs&cat_id=15971&cur_page=1`,name:`法定主动内容`},gsgg:{basicUrl:`https://www.mz.gov.cn/info/iList.jsp?node_id=GKmzs&cat_id=24186&cur_page=1`,name:`公示公告`}}}},l=async(e,t)=>{let n=await i(t),r=s(n.data),a=r(`.list_div li`).toArray().map(t=>({title:r(`a`,t).attr(`title`),url:`${e}${r(`a`,t).attr(`href`)}`}));return a},u=(t,r)=>e.tryGet(r.url,async()=>{let e=await i(r.url);try{let i=s(e.data),o=i(`#attribute > span.gk.fj > file`).toArray().map(e=>({name:i(e).text(),url:`${t}/${i(e).attr(`href`)}`})),c=i(`#attribute > span:nth-child(3)`).text().split(`：`)[1].trim();return{title:i(`h1`).text().trim(),id:i(`#attribute > span:nth-child(1)`).text().split(`：`)[1].trim(),infoNum:i(`#attribute > span:nth-child(2)`).text().split(`：`)[1].trim(),pubDate:n(a(c,8)),date:c,keyWord:i(`#attribute > span:nth-child(6)`).text().split(`：`)[1].trim(),source:i(`#attribute > span:nth-child(5)`).text().split(`：`)[1].trim(),content:i(`body > section > article`).html(),file:o,link:r.url,_isCompleteInfo:!0}}catch{return{title:r.title,link:r.url,_isCompleteInfo:!1}}}),d={path:`/sichuan/deyang/govpublicinfo/:countyName/:infoType?`,categories:[`government`],example:`/gov/sichuan/deyang/govpublicinfo/绵竹市`,parameters:{countyName:"区县名（**其他区县整改中，暂时只支持`绵竹市`**）。德阳市、绵竹市、广汉市、什邡市、中江县、罗江区、旌阳区、高新区",infoType:`信息类型。默认值:fdzdnr-“法定主动内容”`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`政府公开信息`,maintainers:[`zytomorrow`],handler:f,description:`| 法定主动内容 | 公示公告 |
| :----------: | :------: |
|    fdzdnr    |   gsgg   |`};async function f(e){let n=e.req.param(`countyName`),i=e.req.param(`infoType`)||`fdzdnr`,a=c[n].infoType[i].basicUrl,s=c[n].rootUrl,d=await l(s,a),f=await Promise.all(d.map(e=>u(s,e)));return{title:`政府公开信息-${n}-${c[n].infoType[i].name}`,link:a,item:f.map(e=>({title:e.title,description:t(o.join(r,`templates/govPublicInfo-dc755dd7.art`),{item:e}),link:e.link,pubDate:e.pubDate}))}}export{d as route};