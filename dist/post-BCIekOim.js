import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import"./helpers-LVq640iW.js";import{art as e}from"./render-DE4LRFBD.js";import{parseDate as t}from"./parse-date-DHsdom8D.js";import"./ofetch-DRl42yaJ.js";import{__dirname as n}from"./esm-shims-BDPl6Msv.js";import{got_default as r}from"./got-BaOFZRd4.js";import i from"node:path";const a={path:`/post/:id`,categories:[`bbs`],example:`/douyu/post/631737151576473201`,parameters:{id:`帖子 id，可在帖子页 URL 中找到`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`yuba.douyu.com/p/:id`,`yuba.douyu.com/`]}],name:`鱼吧跟帖`,maintainers:[`nczitzk`],handler:o};async function o(a){let o=a.req.param(`id`),s=`https://yuba.douyu.com`,c=`${s}/p/${o}`,l=`${s}/wbapi/web/post/detail/${o}`,u=await r({method:`get`,url:l}),d=u.data.data,f=`${s}/wbapi/web/post/comments/${o}?group_id=${d.group_id}&sink=1&page=1`,p=await r({method:`get`,url:f});f=`${s}/wbapi/web/post/comments/${o}?group_id=${d.group_id}&sink=1&page=${p.data.page_total}`,p=await r({method:`get`,url:f});let m=p.data.data.map(r=>({title:`${r.nick_name}: ${r.content}`,link:`${c}#${r.comment_id}${r.sub_replies.length>0?`+${r.sub_replies.map(e=>e.comment_id).join(`+`)}`:``}`,pubDate:t(r.created_ts*1e3),description:e(i.join(n,`templates/description-45e4c66d.art`),{content:r.content,images:r.imglist.map(e=>({size:e.size,url:e.url})),replies:r.sub_replies.map(e=>({nickname:e.nickname,content:e.content,time:new Date(e.created_ts*1e3).toLocaleString()}))??void 0})}));return{title:`斗鱼鱼吧 - ${d.title}`,link:c,item:m,description:d.content}}export{a as route};