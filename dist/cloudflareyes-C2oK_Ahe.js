import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import"./helpers-LVq640iW.js";import{art as e}from"./render-DE4LRFBD.js";import{parseDate as t}from"./parse-date-DHsdom8D.js";import"./ofetch-DRl42yaJ.js";import{__dirname as n}from"./esm-shims-BDPl6Msv.js";import{got_default as r}from"./got-BaOFZRd4.js";import{timezone as i}from"./timezone-BrxBCotj.js";import a from"node:path";import{load as o}from"cheerio";const s={CM:`中国移动`,CU:`中国联通`,CT:`中国电信`},c={path:`/cloudflareyes/:type?`,categories:[`other`],example:`/hostmonit/cloudflareyes`,parameters:{type:`类型，见下表，默认为 v4`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`CloudFlareYes`,maintainers:[`nczitzk`],handler:l,description:`| v4 | v6 |
| -- | -- |
|    | v6 |`};async function l(c){let{type:l=`v4`}=c.req.param(),u=c.req.query(`limit`)?Number.parseInt(c.req.query(`limit`),10):30,d=`hostmonit.com`,f=`CloudFlareYes${l===`v6`?l.toUpperCase():``}`,p=`https://stock.${d}`,m=`https://api.${d}`,h=new URL(`get_optimization_ip`,m).href,g=new URL(f,p).href,{data:_}=await r.post(h,{json:{key:`iDetkOys`,...l===`v6`?{type:`v6`}:{}}}),v=_.info.slice(0,u).map(r=>{let o=r.ip,c=r.latency===void 0?void 0:`${r.latency}ms`,l=r.line===void 0?void 0:Object.hasOwn(s,r.line)?s[r.line]:r.line,u=r.loss===void 0?void 0:`${r.loss}%`,p=r.node,m=r.speed===void 0?void 0:`${r.speed} KB/s`,h=i(t(r.time),8);return{title:e(a.join(n,`templates/title-c8d56156.art`),{line:l,latency:c,loss:u,speed:m,node:p,ip:o}),link:g,description:e(a.join(n,`templates/description-0589dc12.art`),{line:l,node:p,ip:o,latency:c,loss:u,speed:m}),author:p,category:[l,c,u,p].filter(Boolean),guid:`${d}-${f}-${o}#${h.toISOString()}`,pubDate:h}}),{data:y}=await r(g),b=o(y),x=new URL(b(`link[rel="icon"]`).prop(`href`),p).href;return{item:v,title:b(`title`).text().replace(/- .*$/,`- ${f}`),link:g,description:b(`meta[name="description"]`).prop(`content`),language:b(`html`).prop(`lang`),icon:x,logo:x,subtitle:f,author:b(`title`).text().split(/\s-/)[0],allowEmpty:!0}}export{c as route};