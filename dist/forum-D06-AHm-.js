import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import"./helpers-LVq640iW.js";import{cache_default as e}from"./cache-C3AIQtoX.js";import{art as t}from"./render-DE4LRFBD.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import"./ofetch-DRl42yaJ.js";import{__dirname as r}from"./esm-shims-BDPl6Msv.js";import{got_default as i}from"./got-BaOFZRd4.js";import{viewForum as a,viewThread as o}from"./query-CQPKTgz4.js";import s from"node:path";const c={path:`/forum/:id?/:digest?`,radar:[{source:[`lkong.com/forum/:id`,`lkong.com/`]}],name:`Unknown`,maintainers:[`nczitzk`,`ma6254`],handler:l};async function l(c){let l=c.req.param(`id`)??`8`,u=c.req.param(`digest`),d=`https://www.lkong.com`,f=`https://api.lkong.com/api`,p=`${d}/forum/${l}`,m=await i({method:`post`,url:f,json:a(l)}),h=m.data.data[u?`hots`:`threads`].map(e=>({guid:e.tid,title:e.title,link:`${d}/thread/${e.tid}`}));return h=await Promise.all(h.map(a=>e.tryGet(a.link,async()=>{let e=await i({method:`post`,url:f,json:o(a.guid,1)});return a.author=e.data.data.thread?.author.name,a.pubDate=n(e.data.data.thread?.dateline),a.description=t(s.join(r,`templates/content-b0aebebb.art`),{content:JSON.parse(e.data.data.posts[0].content)}),delete a.guid,a}))),{title:`${m.data.data.forum.name} - 龙空`,link:p,item:h,description:m.data.data.forumCount.info}}export{c as route};