import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import"./helpers-LVq640iW.js";import{cache_default as e}from"./cache-C3AIQtoX.js";import{art as t}from"./render-DE4LRFBD.js";import"./ofetch-DRl42yaJ.js";import{__dirname as n}from"./esm-shims-BDPl6Msv.js";import{got_default as r}from"./got-BaOFZRd4.js";import i from"node:path";import{load as a}from"cheerio";const o=`https://freecomputerbooks.com/`;async function s(e){return a((await r(e)).data)}const c={path:`/:category?`,name:`Book List`,url:new URL(o).host,maintainers:[`cubroe`],handler:l,example:`/freecomputerbooks/compscAlgorithmBooks`,parameters:{category:"A category id., which should be the HTML file name (but **without** the `.html` suffix) in the URL path of a book list page."},categories:[`reading`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`freecomputerbooks.com/`,`freecomputerbooks.com/index.html`],target:``}]};async function l(t){let n=t.req.param(`category`)?.trim(),r=n?new URL(`${n}.html`,o).href:o,i=await s(r),a=i(`.maintitlebar`).text();return{title:`Free Computer Books - `+a,link:r,description:i(`title`).text(),item:await Promise.all(i(`ul[id^=newBooks] > li`).toArray().map(t=>u(i(t),a,e)))}}function u(e,t,n){let r=a(``),i=e.find(`a:first`),s=e.find(`p:contains("Post under")`),c={title:i.text(),link:new URL(i.attr(`href`),o).href,category:s.length?s.find(`a`).toArray().map(e=>r(e).text()):t};return n.tryGet(c.link,()=>d(c))}async function d(e){let r=await s(e.link);r.root().find(`*`).contents().filter((e,t)=>t.type===`comment`).remove();let a=r(`#bookdesc img[title]`).attr(`src`),o=r(`#booktitle ul`).removeAttr(`style`),c=r(`#bookdesccontent`).removeAttr(`id`);return o.find(`li:contains(Share This)`).remove(),c.find(`img[src$="/hot.gif"]`).remove(),c.find(`:contains(Similar Books)`).nextAll().addBack().remove(),e.description=t(i.join(n,`templates/desc-dc50e91a.art`),{imageURL:a,metadata:o,content:c}),e}export{c as route};