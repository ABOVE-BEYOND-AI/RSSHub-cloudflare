import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import"./helpers-LVq640iW.js";import{cache_default as e}from"./cache-C3AIQtoX.js";import{art as t}from"./render-DE4LRFBD.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import"./ofetch-DRl42yaJ.js";import{__dirname as r}from"./esm-shims-BDPl6Msv.js";import{got_default as i}from"./got-BaOFZRd4.js";import a from"node:path";import o from"dayjs";import{load as s}from"cheerio";const c={path:`/programs`,categories:[`program-update`],example:`/appstorrent/programs`,name:`Programs`,maintainers:[`xzzpig`],handler:l,url:`appstorrent.ru/programs/`};async function l(c){let l=c?.req.query(`limit`)?Number.parseInt(c?.req.query(`limit`)??`20`):20,u=`https://appstorrent.ru`,d=`${u}/programs/`,f={http2:!0},p=await i(d,f),m=s(p.data),h=m(`article.soft-item:not(.locked)`).slice(0,l).toArray().map(e=>{let t=m(e);return{title:t.find(`.subtitle`).text().trim(),link:t.find(`.subtitle a`).attr(`href`),category:[t.find(`.info .category`).text().trim()],version:t.find(`.version`).text(),architecture:t.find(`.architecture`).text().trim(),size:t.find(`.size`).text().trim()}}),g=await Promise.all(h.map(c=>e.tryGet(c.link,async()=>{let e=await i(c.link,f),l=s(e.data),d=n(l(`.tech-info .date-news a`).attr(`href`)?.replace(`https://appstorrent.ru/`,``)??``);return{title:c.title,link:c.link,category:c.category,pubDate:d,description:t(a.join(r,`templates/description-9593c953.art`),{cover:u+l(`.main-title img`).attr(`src`)?.trim(),title:c.title,pubDate:o(d).format(`YYYY-MM-DD`),version:c.version,architecture:c.architecture,compatibility:l(`div.right > div.info > div.right-container > div:nth-child(5) > div > span:nth-child(2) > a`).text(),size:c.size,activation:l(`div.right > div.info > div.right-container > div:nth-child(4) > div > span:nth-child(2) > a`).text(),description:l(`.content .body-content`).first().text(),changelog:l(`.content .body-content`).last().text(),screenshots:l(`.screenshots img`).toArray().map(e=>l(e).attr(`src`)).map(e=>u+e)})}})));return{title:m(`title`).text(),link:d.toString(),allowEmpty:!0,item:g}}export{c as route};