import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import{cache_default as e}from"./cache-C3AIQtoX.js";import{art as t}from"./render-DE4LRFBD.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import{ofetch_default as r}from"./ofetch-DRl42yaJ.js";import{__dirname as i}from"./esm-shims-BDPl6Msv.js";import{timezone as a}from"./timezone-BrxBCotj.js";import{ViewType as o}from"./types-D9T3SQ-7.js";import s from"node:path";import{load as c}from"cheerio";const l=async o=>{let l=Number.parseInt(o.req.query(`limit`)??`10`,10),u=`https://musikguru.de`,d=new URL(`news/`,u).href,f=await r(d),p=c(f),m=p(`html`).attr(`lang`)??`de`,h=[];return h=p(`section`).eq(1).find(`div.card`).slice(0,l).toArray().map(e=>{let n=p(e),r=n.find(`h5.card-title`).text(),a=n.find(`img`).attr(`src`),o=t(s.join(i,`templates/description-881baa33.art`),{images:a?[{src:a,alt:r}]:void 0,intro:n.find(`p.card-text`).text()}),c=n.find(`a`).first().attr(`href`),l={title:r,description:o,link:c?new URL(c,u).href:void 0,content:{html:o,text:o},image:a,banner:a,language:m};return l}),h=await Promise.all(h.map(o=>o.link?e.tryGet(o.link,async()=>{let e=await r(o.link),l=c(e),u=l(`div.article h1`).text(),d=o.description+t(s.join(i,`templates/description-881baa33.art`),{description:(l(`p.lead`).html()??``)+(l(`div.lead`).html()??``)}),f=l(`div.article div.text-muted`).text().split(/\sUhr/)?.[0],p=l(`div.article img`).first().attr(`src`),h=f,g={title:u,description:d,pubDate:f?a(n(f,`DD.MM.YYYY HH:mm`),1):o.pubDate,content:{html:d,text:d},image:p,banner:p,updated:h?a(n(h,`DD.MM.YYYY HH:mm`),1):o.updated,language:m};return{...o,...g}}):o)),{title:p(`title`).text(),description:p(`meta[name="description"]`).attr(`content`),link:d,item:h,allowEmpty:!0,image:p(`a.navbar-brand img`).attr(`src`)?new URL(p(`a.navbar-brand img`).attr(`src`),u).href:void 0,author:p(`a.navbar-brand img`).attr(`alt`),language:m,id:d}},u={path:`/news`,name:`News`,url:`musikguru.de`,maintainers:[`nczitzk`],handler:l,example:`/musikguru/news`,parameters:void 0,description:void 0,categories:[`multimedia`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`musikguru.de/news`],target:`news`}],view:o.Articles};export{l as handler,u as route};