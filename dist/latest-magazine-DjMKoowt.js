import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import"./helpers-LVq640iW.js";import{art as e}from"./render-DE4LRFBD.js";import"./ofetch-DRl42yaJ.js";import{__dirname as t}from"./esm-shims-BDPl6Msv.js";import{got_default as n}from"./got-BaOFZRd4.js";import r from"node:path";import{load as i}from"cheerio";const a={path:`/latest-magazine/:query?`,categories:[`reading`],example:`/magazinelib/latest-magazine/new+yorker`,parameters:{query:`query, search page querystring`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`Latest Magazine`,maintainers:[`EthanWng97`],handler:o,description:"For instance, when doing search at [https://magazinelib.com](https://magazinelib.com) and you get url `https://magazinelib.com/?s=new+yorker`, the query is `new+yorker`"};async function o(a){let o=a.req.param(`query`),s=await n({method:`get`,url:`https://magazinelib.com/wp-json/wp/v2/posts/`,searchParams:{search:o,per_page:30,_embed:1}}),c=o;c===void 0?c=``:(c=c.replaceAll(/[^\dA-Za-z]+/g,` `).toUpperCase(),c=` - ${c}`);let l=s.data.map(n=>{let a={};a.date=n.date_gmt,a.link=n.link,a.featuredMediaLink=n._links[`wp:featuredmedia`][0].href,a.title=n.title.rendered;let o=i(n.content.rendered),s=o(`.vk-att`);s.find(`img[src="https://magazinelib.com/wp-includes/images/media/default.png"]`).remove(),a.content=s.html();let c=n._embedded[`wp:featuredmedia`][0].source_url;return a.description=a.content+e(r.join(t,`templates/magazine-description-5b741265.art`),{imgUrl:c}),a.categories=n._embedded[`wp:term`][0].map(e=>e.name),a});return{title:`MagazineLib - Latest Magazines${c}`,link:`{host}/?s=${o}`,description:`MagazineLib - Latest Magazines${c}`,item:l.map(e=>({title:e.title,link:e.link,category:e.categories,pubDate:new Date(e.pubDate).toUTCString(),description:e.description}))}}export{a as route};