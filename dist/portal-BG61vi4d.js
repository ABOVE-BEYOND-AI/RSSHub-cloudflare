import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import"./helpers-LVq640iW.js";import{cache_default as e}from"./cache-C3AIQtoX.js";import{art as t}from"./render-DE4LRFBD.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import"./ofetch-DRl42yaJ.js";import{__dirname as r}from"./esm-shims-BDPl6Msv.js";import{got_default as i}from"./got-BaOFZRd4.js";import{timezone as a}from"./timezone-BrxBCotj.js";import o from"node:path";import{load as s}from"cheerio";const c=`https://weixin.shmtu.edu.cn/dynamic/shmtuHttps`,l=`https://portal.shmtu.edu.cn/api`,u=async e=>{let t=await i.post(c,{form:{interfaceUrl:e},https:{rejectUnauthorized:!1}});return JSON.parse(t.data)},d=(e,n)=>Promise.all(e.map(e=>n.tryGet(e.link,async()=>{let n=await u(e.link),i=n.field_file,a=n.field_image;return e.description=t(o.join(r,`templates/portal-9c9e2508.art`),{body:n.body.und[0].safe_value,images:a.length!==0&&Object.keys(a).length!==0?a.und:null,files:i.length!==0&&Object.keys(i).length!==0?i.und:null}),e.link=n.path,e}))),f={path:`/portal/:type`,categories:[`university`],example:`/shmtu/portal/bmtzgg`,parameters:{type:`类型名称`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`portal.shmtu.edu.cn/:type`]}],name:`数字平台`,maintainers:[`imbytecat`],handler:p,description:`| 部门通知公告 | 学术与大型活动公告 | 部门动态 |
| ------------ | ------------------ | -------- |
| bmtzgg       | xsydxhdgg          | bmdt     |`};async function p(t){let r=t.req.param(`type`),o;switch(r){case`bmtzgg`:o=`部门通知公告`;break;case`xsydxhdgg`:o=`学术与大型活动公告`;break;case`bmdt`:o=`部门动态`;break;default:o=`未知`;break}let u=await i.post(c,{form:{interfaceUrl:`${l}/${r}.json?page=0`},https:{rejectUnauthorized:!1}}),f=JSON.parse(u.data).map(e=>({title:s(e.title).text(),link:`${l}/node/${e.nid}.json`,pubDate:a(n(e.created),8),category:e.field_department[0],author:e.field_department[0]})),p=await d(f,e);return{title:`上海海事大学 ${o}`,link:`https://portal.shmtu.edu.cn/bumentongzhigonggao`,description:`上海海事大学 数字平台`,item:p}}export{f as route};