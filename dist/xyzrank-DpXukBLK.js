import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import"./helpers-LVq640iW.js";import{art as e}from"./render-DE4LRFBD.js";import{parseDate as t}from"./parse-date-DHsdom8D.js";import"./ofetch-DRl42yaJ.js";import{__dirname as n}from"./esm-shims-BDPl6Msv.js";import{got_default as r}from"./got-BaOFZRd4.js";import i from"node:path";import{load as a}from"cheerio";const o={path:`/:category?`,radar:[{source:[`xyzrank.com/`],target:``}],name:`Unknown`,maintainers:[],handler:s,url:`xyzrank.com/`};async function s(o){let s=o.req.param(`category`)??``,c=`https://xyzrank.com`,l=`${c}/#/${s}`,u=await r({method:`get`,url:c}),d=a(u.data);u=await r({method:`get`,url:u.data.match(/<script type="module" crossorigin src="(.*?)"><\/script>/)[1]});let f=u.data.match(/pI="(.*?)",gI="(.*?)",mI="(.*?)",_I="(.*?)";var/),p={"":{url:f[3],title:`热门节目`,id:`hot-episodes`,type:`episodes`},"hot-podcasts":{url:f[1],title:`热门播客`,id:`full`,type:`podcasts`},"hot-episodes-new":{url:f[4],title:`新锐节目`,id:`hot-episodes-new`,type:`episodes`},"new-podcasts":{url:f[2],title:`新锐播客`,id:`new-podcasts`,type:`podcasts`}};u=await r({method:`get`,url:p[s].url});let m=p[s].type,h=u.data.data[m].slice(0,o.req.query(`limit`)?Number.parseInt(o.req.query(`limit`)):250).map((r,a)=>({title:`#${a+1} ${r.title??r.name}`,category:[r.primaryGenreName],author:r.authorsText,link:`${r.link??r.links[0].url}${r.trackCount?`#${r.trackCount}`:``}`,pubDate:t(r.postTime??r.lastReleaseDate),description:e(i.join(n,`templates/description-65025fc9.art`),{logo:r.logoURL,items:m===`podcasts`?{"#":a+1,播客电台:r.name,主持:r.authorsText,分类:r.primaryGenreName,更新频率:`${(r.avgUpdateFreq/24).toFixed(1)}天`,最近更新:`${r.lastReleaseDateDayCount.toFixed(1)}天前`,总集数:r.trackCount,平均时长:`${r.avgDuration}′`,平均播放量:r.avgPlayCount,平均评论量:r.avgCommentCount,千播互动量:(r.avgInteractIndicator*1e3).toFixed(0),平均打开率:`${(r.avgOpenRate*100).toFixed(1)}%`,小宇宙:r.links[0].url,"Apple Podcasts":r.links[1].url,官方网站:r.links[2].url,"RSS 订阅":r.links[3].url}:{"#":a+1,节目标题:r.title,播客电台:r.podcastName,播放量:r.playCount,评论量:r.commentCount,互动率:`${(r.commentCount/r.playCount*100).toFixed(1)}%`,打开率:`${(r.openRate*100).toFixed(1)}%`,时长:`${r.duration}′`,发布时间:r.postTime,分类:r.primaryGenreName,链接:r.link}})}));return{title:`${d(`title`).text()} - ${p[s].title}`,link:l,item:h,description:d(`meta[property="og:description"]`).attr(`content`)}}export{o as route};