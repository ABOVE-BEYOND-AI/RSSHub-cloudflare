import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import"./helpers-LVq640iW.js";import{art as e}from"./render-DE4LRFBD.js";import{parseDate as t}from"./parse-date-DHsdom8D.js";import"./ofetch-DRl42yaJ.js";import{__dirname as n}from"./esm-shims-BDPl6Msv.js";import{got_default as r}from"./got-BaOFZRd4.js";import{invalid_parameter_default as i}from"./invalid-parameter-CfUmvEUg.js";import a from"node:path";import{load as o}from"cheerio";const s={path:`/album/:id`,categories:[`multimedia`],example:`/iqiyi/album/神武天尊-2020-1b4lufwxd7h`,parameters:{id:`剧集 id, 可在该主页 URL 中找到`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`剧集`,maintainers:[`TonyRL`],handler:c,description:`::: tip
  可抓取內容根据服务器所在地区而定
:::`};async function c(s){let c=s.req.param(`id`),{data:l}=await r(`https://www.iq.com/album/${c}`),u=o(l),d=JSON.parse(u(`#__NEXT_DATA__`).text()),{album:f}=d.props.initialState,{data:{data:p}}=await r(`https://pcw-api.iqiyi.com/album/album/baseinfo/${f.videoAlbumInfo.albumId}`);if(Object.keys(f.cacheAlbumList).length===0)throw new i(`${p.name} is not available in this server region.`);let m=1,h=!1,g=[];do{let{data:{data:e}}=await r(`https://pcw-api.iq.com/api/v2/episodeListSource/${f.videoAlbumInfo.albumId}`,{searchParams:{platformId:3,modeCode:`intl`,langCode:`zh_cn`,endOrder:f.videoAlbumInfo.maxOrder,startOrder:m}});g=[...g,...e.epg],m=e.pos,h=e.hasMore}while(h);let _=g.map(r=>({title:r.name,description:e(a.join(n,`templates/album-456d4501.art`),{item:r}),link:`https://www.iq.com/play/${r.playLocSuffix}`,pubDate:t(r.initIssueTime)}));return{title:p.name,description:p.description,image:f.videoAlbumInfo.albumFocus1024,link:`https://www.iq.com/album/${f.videoAlbumInfo.albumLocSuffix}`,item:_,allowEmpty:!0}}export{s as route};