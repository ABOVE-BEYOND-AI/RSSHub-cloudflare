import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import{cache_default as e}from"./cache-C3AIQtoX.js";import{art as t}from"./render-DE4LRFBD.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import{ofetch_default as r}from"./ofetch-DRl42yaJ.js";import{__dirname as i}from"./esm-shims-BDPl6Msv.js";import a from"node:path";const o=`https://seekingalpha.com`,s={path:`/:symbol/:category?`,categories:[`finance`],example:`/seekingalpha/TSM/transcripts`,parameters:{symbol:`Stock symbol`,category:"Category, see below, `news` by default"},features:{antiCrawler:!0},radar:[{source:[`seekingalpha.com/symbol/:symbol/:category`,`seekingalpha.com/symbol/:symbol/earnings/:category`],target:`/:symbol/:category`}],name:`Summary`,maintainers:[`TonyRL`],handler:u,description:`| Analysis | News | Transcripts | Press Releases | Related Analysis |
| -------- | ---- | ----------- | -------------- | ---------------- |
| analysis | news | transcripts | press-releases | related-analysis |`},c=()=>e.tryGet(`seekingalpha:machine_cookie`,async()=>{let e=await r.raw(o);return e.headers.getSetCookie().map(e=>e.split(`;`)[0])}),l={article:{slug:`/articles`,include:`author,primaryTickers,secondaryTickers,otherTags,presentations,presentations.slides,author.authorResearch,author.userBioTags,co_authors,promotedService,sentiments`},news:{slug:`/news`,include:`author,primaryTickers,secondaryTickers,otherTags`},pr:{slug:`/press_releases`,include:`acquireService,primaryTickers`}};async function u(s){let{category:u=`news`,symbol:d}=s.req.param(),f=`${o}/symbol/${d.toUpperCase()}/${u===`transcripts`?`earnings/${u}`:u}`,p=await c(),m=await r(`${o}/api/v3/symbols/${d.toUpperCase()}/${u}`,{headers:{cookie:p.join(`; `)},query:{"filter[since]":0,"filter[until]":0,id:d.toLowerCase(),include:`author,primaryTickers,secondaryTickers,sentiments`,"page[size]":s.req.query(`limit`)?Number.parseInt(s.req.query(`limit`),10):u===`news`?40:20,"page[number]":1}}),h=m.data?.map(e=>({title:e.attributes.title,link:new URL(e.links.self,o).href,pubDate:n(e.attributes.publishOn),author:m.included.find(t=>t.id===e.relationships.author.data.id).attributes.nick,id:e.id,articleType:e.links.self.split(`/`)[1]})),g=h?await Promise.all(h.map(s=>e.tryGet(s.link,async()=>{let e=await r(`${o}/api/v3${l[s.articleType].slug}/${s.id}`,{headers:{cookie:p.join(`; `)},query:{include:l[s.articleType].include}});return s.category=e.included.filter(e=>e.type===`tag`).map(e=>e.attributes.company?`${e.attributes.company} (${e.attributes.name})`:e.attributes.name),s.description=(e.data.attributes.summary?.length?t(a.join(i,`templates/summary-32bc2e37.art`),{summary:e.data.attributes.summary}):``)+e.data.attributes.content,s.updated=n(e.data.attributes.lastModified),s}))):[];return{title:m.meta.page.title,description:m.meta.page.description,link:f,image:`https://seekingalpha.com/samw/static/images/favicon.svg`,item:g,allowEmpty:!0,language:`en-US`}}export{s as route};