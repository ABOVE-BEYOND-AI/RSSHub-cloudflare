import{art as e}from"./render-DE4LRFBD.js";import{__dirname as t}from"./esm-shims-BDPl6Msv.js";import{invalid_parameter_default as n}from"./invalid-parameter-CfUmvEUg.js";import{fallback as r,queryToBoolean as i}from"./readable-social-Dobs5p4y.js";import a from"node:path";import o from"dayjs";import s from"rss-parser";const c=/(.+)\s+is\s+([A-Z]+)\s+\((.+)\)/,l=e=>{let t=o.duration(e-0,`seconds`),n=t.days(),r=t.hours(),i=t.minutes(),a=t.seconds();return n>0?`${n}d ${r}h ${i}m ${a}s`:r>0?`${r}h ${i}m ${a}s`:i>0?`${i}m ${a}s`:`${a}s`};var u=class{constructor(e,t=0,n=0){this.name=e,this.uptime=t,this.downtime=n}uptimeRatio(){return this.uptime/(this.uptime+this.downtime)}downtimeRatio(){return this.downtime/(this.uptime+this.downtime)}up(e){this.uptime+=e-0}down(e){this.downtime+=e-0}};const d={path:`/rss/:id/:routeParams?`,categories:[`forecast`],example:`/uptimerobot/rss/u358785-e4323652448755805d668f1a66506f2f`,parameters:{id:"the last part of your RSS URL (e.g. `u358785-e4323652448755805d668f1a66506f2f` for `https://rss.uptimerobot.com/u358785-e4323652448755805d668f1a66506f2f`)",routeParams:`extra parameters, see the table below`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`rss.uptimerobot.com/:id`],target:`/rss/:id`}],name:`RSS`,maintainers:[`Rongronggg9`],handler:f,description:`| Key    | Description                                                              | Accepts        | Defaults to |
| ------ | ------------------------------------------------------------------------ | -------------- | ----------- |
| showID | Show monitor ID (disabling it will also disable link for each RSS entry) | 0/1/true/false | true        |`};async function f(o){let d=o.req.param(`id`),f=Object.fromEntries(new URLSearchParams(o.req.param(`routeParams`))),p=r(void 0,i(f.showID),!0),m=`https://rss.uptimerobot.com/${d}`,h=await new s({customFields:{item:[`details:duration`]}}).parseURL(m),g={},_=h.items.toReversed().map(r=>{let i=r.title.match(c);if(!i)throw new n(`Unexpected title, please open an issue.`);let[o,s,d]=i.slice(1);if(d!==r.link)throw new n(`Monitor ID mismatch, please open an issue.`);let f;try{f=!d.startsWith(`http`)&&d.includes(`.`)?new URL(`http://${d}`).href:new URL(d).href}catch{}let m=r[`details:duration`],h=g[o]=g[o]||new u(o);if(s===`UP`)h.up(m);else if(s===`DOWN`)h.down(m);else throw new n(`Unexpected status, please open an issue.`);let _=e(a.join(t,`templates/rss-2f6e4dda.art`),{status:s,link:f,id:p?d:null,duration:l(m),uptime:l(h.uptime),downtime:l(h.downtime),uptime_ratio:Number(h.uptimeRatio()).toLocaleString(void 0,{style:`percent`,minimumFractionDigits:2}),details:r.content});return{...r,title:`[${s}] ${o}`,description:_,link:p?f:null}});return{title:`Uptime Robot - RSS (enhanced)`,description:h.description,link:m,item:_,image:`https://uptimerobot.com/favicon.ico`}}export{d as route};