import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import"./helpers-LVq640iW.js";import{cache_default as e}from"./cache-C3AIQtoX.js";import{art as t}from"./render-DE4LRFBD.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import"./ofetch-DRl42yaJ.js";import{__dirname as r}from"./esm-shims-BDPl6Msv.js";import{got_default as i}from"./got-BaOFZRd4.js";import a from"node:path";import{load as o}from"cheerio";import s from"iconv-lite";const c={path:`/new`,categories:[`blog`],example:`/xys/new`,parameters:{},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`xys.org/`,`xys.org/new.html`]}],name:`新到资料`,maintainers:[`wenzhenl`],handler:l,url:`xys.org/`};async function l(c){let l=`http://www.xys.org`,u=`${l}/new.html`,d=await i({method:`get`,url:u,responseType:`buffer`}),f=s.decode(d.data,`gb2312`),p=o(f),m=p(`li a`).slice(4,c.req.query(`limit`)?Number.parseInt(c.req.query(`limit`)):30).toArray().map(e=>{e=p(e);let t=e.attr(`href`);/^https?:\/\//.test(t)||(t=l+`/`+t.replace(/^\//,``));let r=e.parent().text().trim().slice(0,8);return r=n(r,`YY.MM.DD`),{title:e.text(),link:t,pubDate:r}});return m=await Promise.all(m.filter(e=>!e.link.endsWith(`.zip`)).map(n=>e.tryGet(n.link,async()=>{let e=/(?:https?:\/\/)?(?:www\.)?youtu\.?be(?:\.com)?\/?.*(?:watch|embed)?(?:.*v=|v\/|\/)([\w-]+)&?/g,c=n.link.match(e);if(c)n.description=t(a.join(r,`templates/desc-2f9d87ea.art`),{youTube:n.link.slice(32)});else{let e=await i({method:`get`,url:n.link,responseType:`buffer`}),t=s.decode(e.data,`gb2312`),r=o(t);n.description=r.text().replaceAll(`
`,`<br>
`)}return n}))),{title:`新语丝 - 新到资料`,link:u,item:m}}export{c as route};