import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import"./helpers-LVq640iW.js";import{cache_default as e}from"./cache-C3AIQtoX.js";import{art as t}from"./render-DE4LRFBD.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import"./ofetch-DRl42yaJ.js";import{__dirname as r}from"./esm-shims-BDPl6Msv.js";import{got_default as i}from"./got-BaOFZRd4.js";import a from"node:path";import{load as o}from"cheerio";const s={path:`/forestry/gjlckjdjt/:category?`,categories:[`government`],example:`/gov/forestry/gjlckjdjt`,parameters:{category:`分类，见下表，默认为全部`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`国家林草科技大讲堂`,maintainers:[`nczitzk`],handler:c,description:`| 分类     | id   |
| -------- | ---- |
| 经济林   | jjl  |
| 林木良种 | lmlz |
| 林下经济 | lxjj |
| 生态修复 | stxf |
| 用材林   | ycl  |
| 其他     | qt   |`};async function c(s){let{category:c=`gjlckjdjt`}=s.req.param(),l=s.req.query(`limit`)?Number.parseInt(s.req.query(`limit`),10):30,u=`http://www.forestry.gov.cn`,d=new URL(`${c}.jhtml`,u).href,{data:f}=await i(d),p=o(f),m=p(`a.items`).slice(0,l).toArray().map(e=>{e=p(e);let i=e.find(`p.name`).text(),o=new URL(e.prop(`href`),u).href,s=o.match(/\/\d{8}\//);return{title:i,link:o,description:t(a.join(r,`templates/description-e2cc2c72.art`),{image:{src:e.find(`img`).prop(`src`),alt:i}}),pubDate:s?n(s[1]):void 0}});m=await Promise.all(m.map(s=>e.tryGet(s.link,async()=>{let{data:e}=await i(s.link),c=o(e);c(`p`).each((e,t)=>{t=c(t),t.find(`img, video, embed.edui-faked-video`).length===0&&/^\s*$/.test(t.text())&&t.remove()}),c(`video, embed.edui-faked-video`).each((e,n)=>{n=c(n);let i=n.prop(`src`);s.enclosure_url=s.enclosure_url??i,n.replaceWith(t(a.join(r,`templates/description-e2cc2c72.art`),{video:{src:i}}))});let l=s.link.match(/\/\d{8}\//);return s.title=c(`div.tit`).text(),s.description+=c(`div.zhengwen`).html(),s.pubDate=l?n(l[1]):void 0,s.enclosure_type=s.enclosure_url?`video/mp4`:void 0,s})));let h=new URL(`favicon.ico`,u).href;return{item:m,title:p(`title`).text(),link:d,language:p(`html`).prop(`lang`),image:new URL(`r/cms/www/default/zhuanti/2021djt/images/top.png`,u).href,icon:h,logo:h,subtitle:p(`div.weizhi`).contents().last().text(),author:`国家林业和草原局`,allowEmpty:!0}}export{s as route};