import{config as e}from"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import{cache_default as t}from"./cache-C3AIQtoX.js";import{art as n}from"./render-DE4LRFBD.js";import{parseDate as r}from"./parse-date-DHsdom8D.js";import{ofetch_default as i}from"./ofetch-DRl42yaJ.js";import{__dirname as a}from"./esm-shims-BDPl6Msv.js";import o from"node:path";import*as s from"cheerio";const c=`https://www.famitsu.com`,l={path:`/category/:category?`,categories:[`game`],example:`/famitsu/category/new-article`,parameters:{category:"Category, see table below, `new-article` by default"},radar:[{source:[`www.famitsu.com/category/:category/page/1`]}],name:`Category`,maintainers:[`TonyRL`],handler:p,description:`| 新着        | Switch | PS5 | PS4 | PC ゲーム | ニュース | 動画   | 特集・企画記事  | インタビュー | 取材・リポート | レビュー | インディーゲーム |
| ----------- | ------ | --- | --- | --------- | -------- | ------ | --------------- | ------------ | -------------- | -------- | ---------------- |
| new-article | switch | ps5 | ps4 | pc-game   | news     | videos | special-article | interview    | event-report   | review   | indie-game       |`};function u(){return t.tryGet(`famitsu:buildId`,async()=>{let e=await i(c),t=s.load(e),n=JSON.parse(t(`#__NEXT_DATA__`).text());return n.buildId},e.cache.routeExpire,!1)}function d(e){return n(o.join(a,`templates/description-d0da8b01.art`),e)}function f(e){if(Array.isArray(e.content))return e.content.map(e=>e.type&&f(e)).join(``);switch(e.type){case`B`:case`INTERVIEWEE`:case`STRONG`:return`<b>${e.content}</b>`;case`HEAD`:return`<h2>${e.content}</h2>`;case`SHEAD`:return`<h3>${e.content}</h3>`;case`LINK_B`:case`LINK_B_TAB`:return`<a href="${e.url}"><b>${e.content}</b></a><br>`;case`IMAGE`:return`<img src="${e.path}">`;case`NEWS`:return`<a href="${e.url}">${e.content}<br>${e.description}</a><br>`;case`HTML`:return e.content;case`ANNOTATION`:case`CAPTION`:case`ITEMIZATION`:case`ITEMIZATION_NUM`:case`NOLINK`:case`STRING`:case`TWITTER`:case`YOUTUBE`:return`<div><span>${e.content}</span></div>`;case`BUTTON`:case`BUTTON_ANDROID`:case`BUTTON_EC`:case`BUTTON_IOS`:case`BUTTON_TAB`:case`LINK`:case`LINK_TAB`:return`<a href="${e.url}">${e.content}</a><br>`;default:throw Error(`Unhandle type: ${e.type}`)}}async function p(e){let{category:n=`new-article`}=e.req.param(),a=`${c}/category/${n}/page/1`,o=await u(),s=await i(`https://www.famitsu.com/_next/data/${o}/category/${n}/page/1.json`,{query:{categoryCode:n,pageNumber:1}}),l=s.pageProps.categoryArticleDataForPc.filter(e=>!e.advertiserName).map(e=>{let t=e.publishedAt?.slice(0,7).replace(`-`,``);return{title:e.title,link:`https://www.famitsu.com/article/${t}/${e.id}`,pubDate:r(e.publishedAt),category:[...new Set([e.mainCategory.nameJa,...e.subCategories?.map(e=>e.nameJa)??[]])],publicationDate:t,articleId:e.id}}),p=await Promise.all(l.map(e=>t.tryGet(e.link,async()=>{let t=await i(`https://www.famitsu.com/_next/data/${o}/article/${e.publicationDate}/${e.articleId}.json`,{query:{publicationDate:e.publicationDate,articleId:e.articleId}}),n=t.pageProps.articleDetailData;return e.author=n.authors?.map(e=>e.name_ja).join(`, `)??n.user.name_ja,e.description=d({bannerImage:n.ogpImageUrl??n.thumbnailUrl,content:n.content.flatMap(e=>e.contents.map(e=>f(e))).join(``)}),e})));return{title:`${s.pageProps.targetCategory.nameJa}の最新記事 | ゲーム・エンタメ最新情報のファミ通.com`,image:`https://www.famitsu.com/img/1812/favicons/apple-touch-icon.png`,link:a,item:p,language:`ja`}}export{l as route};