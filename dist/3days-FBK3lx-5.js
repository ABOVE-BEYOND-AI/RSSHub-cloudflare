import{config as e}from"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import"./helpers-LVq640iW.js";import{cache_default as t}from"./cache-C3AIQtoX.js";import{art as n}from"./render-DE4LRFBD.js";import"./ofetch-DRl42yaJ.js";import{__dirname as r}from"./esm-shims-BDPl6Msv.js";import{got_default as i}from"./got-BaOFZRd4.js";import{config_not_found_default as a}from"./config-not-found-B7nOMdXp.js";import o from"node:path";const s=`QWeather`,c={path:`/3days/:location`,categories:[`forecast`],example:`/qweather/3days/广州`,parameters:{location:`N`},features:{requireConfig:[{name:`HEFENG_KEY`,description:``}],requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`近三天天气`,maintainers:[`Rein-Ou`,`la3rence`],handler:l,description:`获取订阅近三天天气预报`};async function l(c){if(!e.hefeng.key)throw new a(`QWeather RSS is disabled due to the lack of <a href="https://docs.rsshub.app/zh/install/config#%E5%92%8C%E9%A3%8E%E5%A4%A9%E6%B0%94">relevant config</a>`);let l=await t.tryGet(`qweather:`+c.req.param(`location`)+`:id`,async()=>{let t=await i(`https://geoapi.qweather.com/v2/city/lookup?location=${c.req.param(`location`)}&key=${e.hefeng.key}`);return t.data.location[0].id}),u=await t.tryGet(`qweather:`+c.req.param(`location`),async()=>{let t=await i(`https://devapi.qweather.com/v7/weather/3d?key=${e.hefeng.key}&location=${l}`);return t.data},e.cache.contentExpire,!1),d=await t.tryGet(`qweather:air:${c.req.param(`location`)}`,async()=>{let t=await i(`https://devapi.qweather.com/v7/air/5d?location=${l}&key=${e.hefeng.key}`);return t.data},e.cache.contentExpire,!1),f={updateTime:u.updateTime,fxLink:u.fxLink,daily:u.daily.map(e=>{let t=d.daily.find(t=>t.fxDate===e.fxDate);return t?{...e,aqi:t.aqi,aqiLevel:t.level,aqiCategory:t.category,aqiPrimary:t.primary}:e})},p=f.daily.map(e=>({title:`${e.fxDate}: ${e.textDay===e.textNight?e.textDay:e.textDay+`转`+e.textNight} ${e.tempMin}~${e.tempMax}℃`,description:n(o.join(r,`templates/3days-104c7b4f.art`),{item:e}),pubDate:f.updateTime,guid:`位置：`+c.req.param(`location`)+`--日期：`+e.fxDate,link:f.fxLink,author:s}));return{title:c.req.param(`location`)+`未来三天天气`,description:c.req.param(`location`)+`未来三天天气情况，使用和风彩云 API (包括空气质量)`,item:p,link:f.fxLink,author:s}}export{c as route};