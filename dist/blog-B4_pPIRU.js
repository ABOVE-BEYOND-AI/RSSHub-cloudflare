import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import{cache_default as e}from"./cache-C3AIQtoX.js";import{art as t}from"./render-DE4LRFBD.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import{ofetch_default as r}from"./ofetch-DRl42yaJ.js";import{__dirname as i}from"./esm-shims-BDPl6Msv.js";import{ViewType as a}from"./types-D9T3SQ-7.js";import o from"node:path";import{load as s}from"cheerio";const c=async a=>{let c=Number.parseInt(a.req.query(`limit`)??`30`,10),l=`https://mathpix.com`,u=new URL(`blog`,l).href,d=await r(u),f=s(d),p=f(`html`).attr(`lang`)??`en`,m={};f(`div.navbar-menu a.blog-category`).each((e,t)=>{let n=f(t),r=n.attr(`data-category`),i=n.text()?.trim();r&&i&&(m[r]=i)});let h=[];return h=f(`li.articles__item`).slice(0,c).toArray().map(e=>{let r=f(e),a=r.find(`a.articles__title`).text(),s=r.find(`div.articles__image img`).attr(`srcset`)?new URL(r.find(`div.articles__image img`).attr(`srcset`),l).href:void 0,c=t(o.join(i,`templates/description-881baa33.art`),{images:s?[{src:s,alt:a}]:void 0,intro:r.find(`div.articles__text`).text()}),u=r.find(`time.articles__date`).attr(`datetime`),d=r.find(`a.articles__title`).attr(`href`),h=r.attr(`data-category`)?.split(/,\s/).map(e=>e.trim())??[],g=h.map(e=>m[e]).filter(Boolean),_=u,v={title:a,description:c,pubDate:u?n(u):void 0,link:d?new URL(d,l).href:void 0,category:g,content:{html:c,text:c},image:s,banner:s,updated:_?n(_):void 0,language:p};return v}),h=await Promise.all(h.map(t=>t.link?e.tryGet(t.link,async()=>{let e=await r(t.link),n=s(e),i=n(`h1.article__title`).text(),a=n(`div#setText`).html(),o={title:i,description:a,content:{html:a,text:a},language:p};return{...t,...o}}):t)),{title:f(`title`).text(),description:f(`meta[property="og:description"]`).attr(`content`),link:u,item:h,allowEmpty:!0,image:f(`meta[property="og:image"]`).attr(`content`),language:p,id:f(`meta[property="og:url"]`).attr(`content`)}},l={path:`/blog`,name:`Blog`,url:`mathpix.com`,maintainers:[`nczitzk`],handler:c,example:`/mathpix/blog`,parameters:void 0,description:void 0,categories:[`blog`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`mathpix.com/blog`],target:`/blog`}],view:a.Articles};export{c as handler,l as route};