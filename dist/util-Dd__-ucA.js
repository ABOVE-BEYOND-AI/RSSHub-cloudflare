import{art as e}from"./render-DE4LRFBD.js";import{parseDate as t}from"./parse-date-DHsdom8D.js";import{__dirname as n}from"./esm-shims-BDPl6Msv.js";import{got_default as r}from"./got-BaOFZRd4.js";import{timezone as i}from"./timezone-BrxBCotj.js";import a from"node:path";import{load as o}from"cheerio";const s=`whu.edu.cn`,c=e=>{let t={};return e.replaceAll(/<meta name="(.*?)" content="(.*?)"/gi,(e,n,r)=>{t[n]=r}),t},l=(e,t)=>Object.hasOwn(e,t)?e[t]:void 0,u=async(s,u)=>{try{let{data:d}=await r(s.link),f=o(d);f(`p.vsbcontent_img`).each(function(){let t=f(this).find(`img`);f(this).replaceWith(e(a.join(n,`templates/description-9e3ccd8d.art`),{image:{src:new URL(t.prop(`orisrc`),u).href,width:t.prop(`width`)}}))}),f(`script[name="_videourl"]`).each(function(){let t=f(this);t.replaceWith(e(a.join(n,`templates/description-9e3ccd8d.art`),{video:{src:new URL(t.prop(`vurl`).split(`?`)[0],u).href,width:f(t).prop(`vwidth`),height:f(t).prop(`vheight`)}}))});let p=f(`div.v_news_content`).html();f(`form[name="_newscontent_fromname"] table`).remove();let m=f(`form[name="_newscontent_fromname"] ul li`).toArray().map(e=>(e=f(e).find(`a`),{title:e.text(),link:new URL(e.prop(`href`),u).href})),h=c(d);s.title=l(h,`ArticleTitle`)??s.title,s.description=e(a.join(n,`templates/description-9e3ccd8d.art`),{description:p,attachments:m}),s.author=l(h,`ContentSource`),s.category=l(h,`Keywords`)?.split(` `).filter(Boolean)??[],s.guid=l(h,`Url`)??s.link,s.pubDate=l(h,`PubDate`)?i(t(l(h,`PubDate`)),8):s.pubDate,m.length>0&&(s.enclosure_url=m[0].link,s.enclosure_type=`application/${m[0].title.split(`.`).pop()}`)}catch{}return s},d=async(e,t,n)=>await Promise.all(e.map(e=>e.link.includes(s)?t(e.link,async()=>await u(e,n)):e));export{s as domain,l as getMeta,d as processItems,c as processMeta};