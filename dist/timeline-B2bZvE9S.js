import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import"./helpers-LVq640iW.js";import{cache_default as e}from"./cache-C3AIQtoX.js";import{art as t}from"./render-DE4LRFBD.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import"./ofetch-DRl42yaJ.js";import{__dirname as r}from"./esm-shims-BDPl6Msv.js";import{got_default as i}from"./got-BaOFZRd4.js";import{ViewType as a}from"./types-D9T3SQ-7.js";import o from"node:path";import{load as s}from"cheerio";const c={path:`/timeline/:category?`,categories:[`finance`],view:a.Articles,example:`/jinse/timeline`,parameters:{category:{description:`分类`,options:[{value:`头条`,label:`头条`},{value:`独家`,label:`独家`},{value:`铭文`,label:`铭文`},{value:`产业`,label:`产业`},{value:`项目`,label:`项目`},{value:`政策`,label:`政策`},{value:`AI`,label:`AI`},{value:`Web 3.0`,label:`Web 3.0`},{value:`以太坊 2.0`,label:`以太坊 2.0`},{value:`DeFi`,label:`DeFi`},{value:`Layer2`,label:`Layer2`},{value:`NFT`,label:`NFT`},{value:`DAO`,label:`DAO`},{value:`百科`,label:`百科`}],default:`头条`}},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`首页`,maintainers:[`nczitzk`],handler:l,description:`| 头条   | 独家 | 铭文    | 产业       | 项目 |
| ------ | ---- | ------- | ---------- | ---- |
| 政策   | AI   | Web 3.0 | 以太坊 2.0 | DeFi |
| Layer2 | NFT  | DAO     | 百科       |      |`};async function l(a){let{category:c=`头条`}=a.req.param(),l=a.req.query(`limit`)?Number.parseInt(a.req.query(`limit`),10):50,u=`https://www.jinse.cn`,d=new URL(`noah/v3/timelines`,`https://api.jinse.cn`).href,f=u,{data:p}=await i(d,{searchParams:{catelogue_key:c===`头条`?`www`:c,limit:l,information_id:0,flag:`up`}}),m=p.data.list.slice(0,l).map(e=>(e=e.object_1??e.object_2,{title:e.title,link:e.jump_url,description:t(o.join(r,`templates/description-d03b585b.art`),{images:e.cover?[{src:e.cover.replace(/_[^\W_]+(\.\w+)$/,`_true$1`),alt:e.title}]:void 0,intro:e.summary,description:e.content}),author:e.author.nickname,guid:`jinse${/\/lives\//.test(e.jump_url)?`-lives`:``}-${e.id}`,pubDate:n(e.published_at,`X`),upvotes:e.up_counts??0,downvotes:e.down_counts??0,comments:e.comment_count??0}));m=await Promise.all(m.map(n=>e.tryGet(n.link,async()=>{if(/\/lives\//.test(n.link))return n;let{data:e}=await i(n.link),a=s(e);return n.description+=t(o.join(r,`templates/description-d03b585b.art`),{description:a(`section.js-article-content`).html()||a(`div.js-article`).html()}),n.category=a(`section.js-article-tag_state_1 a span`).toArray().map(e=>a(e).text()),n})));let{data:h}=await i(f),g=s(h),_=g(`meta[name="author"]`).prop(`content`),v=g(`a.js-logoBox img`).prop(`src`),y=new URL(g(`link[rel="favicon"]`).prop(`href`),u).href;return{item:m,title:`${_} - ${c}`,link:f,description:g(`meta[name="description"]`).prop(`content`),language:g(`html`).prop(`lang`),image:v,icon:y,logo:y,subtitle:g(`meta[name="keywords"]`).prop(`content`),author:_,allowEmpty:!0}}export{c as route};