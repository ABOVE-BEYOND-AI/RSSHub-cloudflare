import{config as e}from"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import{art as t}from"./render-DE4LRFBD.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import{ofetch_default as r}from"./ofetch-DRl42yaJ.js";import{__dirname as i}from"./esm-shims-BDPl6Msv.js";import a from"node:path";import o from"markdown-it";const s=r.create({headers:{"user-agent":e.trueUA}}),c=o({html:!0}),l={path:`/project/:id/versions/:routeParams?`,categories:[`game`],example:`/modrinth/project/sodium/versions`,parameters:{id:`Id or slug of the Modrinth project`,routeParams:`Extra route params. See the table below for options`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`modrinth.com/mod/:id/*`,`modrinth.com/plugin/:id/*`,`modrinth.com/datapack/:id/*`,`modrinth.com/shader/:id/*`,`modrinth.com/resourcepack/:id/*`,`modrinth.com/modpack/:id/*`,`modrinth.com/mod/:id`,`modrinth.com/plugin/:id`,`modrinth.com/datapack/:id`,`modrinth.com/shader/:id`,`modrinth.com/resourcepack/:id`,`modrinth.com/modpack/:id`],target:`/project/:id/versions`}],name:`Project versions`,maintainers:[`SettingDust`],handler:u,description:`| Name           | Example                                      |
| -------------- | -------------------------------------------- |
| loaders        | loaders=fabric&loaders=quilt&loaders=forge |
| game_versions | game_versions=1.20.1&game_versions=1.20.2 |
| featured       | featured=true                                |`};async function u(e){let{id:r,routeParams:o}=e.req.param(),l=new URLSearchParams(o);try{let e=await s(`https://api.modrinth.com/v2/project/${r}`),o=await s(`https://api.modrinth.com/v2/project/${r}/version`,{query:{loaders:l.has(`loaders`)?JSON.stringify(l.getAll(`loaders`)):``,game_versions:l.has(`game_versions`)?JSON.stringify(l.getAll(`game_versions`)):``}}),u=await s(`https://api.modrinth.com/v2/users`,{query:{ids:JSON.stringify([...new Set(o.map(e=>e.author_id))])}}),d={};for(let e of u)d[e.id]=e;return{title:`${e.title} Modrinth versions`,description:e.description,link:`https://modrinth.com/project/${r}`,item:o.map(e=>({title:`${e.name} for ${e.loaders.join(`/`)} on ${[...new Set([e.game_versions[0],e.game_versions.at(-1)])].join(`-`)}`,link:`https://modrinth.com/project/${r}/version/${e.version_number}`,pubDate:n(e.date_published),description:t(a.join(i,`templates/version-e32ed699.art`),{...e,changelog:c.render(e.changelog)}),guid:e.id,author:d[e.author_id].username}))}}catch(e){throw e?.response?.statusCode===404?Error(`${e.message}: Project ${r} not found`):e}}export{l as route};