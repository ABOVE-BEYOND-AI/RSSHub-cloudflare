import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import"./helpers-LVq640iW.js";import{cache_default as e}from"./cache-C3AIQtoX.js";import{art as t}from"./render-DE4LRFBD.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import"./ofetch-DRl42yaJ.js";import{__dirname as r}from"./esm-shims-BDPl6Msv.js";import{got_default as i}from"./got-BaOFZRd4.js";import a from"node:path";import o from"markdown-it";const s={path:`/release/:user/:app/:distribution_group`,categories:[`program-update`],example:`/app-center/release/cloudflare/1.1.1.1-windows/beta`,parameters:{user:`User`,app:`App name`,distribution_group:`Distribution group`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`install.appcenter.ms/users/:user/apps/:app/distribution_groups/:distribution_group`,`install.appcenter.ms/orgs/:user/apps/:app/distribution_groups/:distribution_group`]}],name:`Release`,maintainers:[`Rongronggg9`],handler:c,description:`::: tip
  The parameters can be extracted from the Release page URL: \`https://install.appcenter.ms/users/:user/apps/:app/distribution_groups/:distribution_group\`
:::`};async function c(s){let c=s.req.param(`user`),l=s.req.param(`app`),u=s.req.param(`distribution_group`),d=`https://install.appcenter.ms/api/v0.1/apps/${c}/${l}/distribution_groups/${u}`,f=`${d}/public_releases?scope=tester`,p=`https://install.appcenter.ms/users/${c}/apps/${l}/distribution_groups/${u}`,m=await i(f),h=m.data.map(e=>({pubDate:n(e.uploaded_at),link:`${d}/releases/${e.id}?is_install_page=true`})),g=new o;h=await Promise.all(h.map(n=>e.tryGet(n.link,async()=>{let e=await i(n.link),o=e.data,s=o.owner.display_name,c=o.app_os,l=o.short_version,u=o.version,d=o.is_external_build,f=o.mandatory_update,m=(o.size/(1024*1024)).toFixed(2),h=o.uploaded_at,_=o.fingerprint,v=o.min_os,y=o.android_min_api_level,b=o.device_family,x=o.bundle_identifier,S=o.release_notes,C=o.download_url,w=o.install_url,T=o.fileExtension,E=o.app_display_name,D=o.distribution_group_id,O=o.distribution_groups.find(e=>e.id===D).display_name;n._feed_title=`${E} (${O}) for ${c} by ${s} - App Center Releases`,n._feed_icon=o.app_icon_url;let k=l&&u?`${l} (${u})`:l||u;return n.title=`${E}: `+(f?`[Mandatory]`:``)+(d?`[External Build]`:``)+`Version ${k}`,n.link=p,n.author=s,n.description=t(a.join(r,`templates/description-13bc6869.art`),{releaseDate:h,sizeInMBytes:m,minOS:v,deviceFamily:b,androidMinApiLevel:y,bundleId:x,downloadUrl:C,installUrl:w,fingerprint:_,appOS:c,fileExtension:T,releaseNotes:S&&g.render(S)},{minimize:!0}),n.guid=_,n})));let _=h&&h[0]._feed_icon,v=h&&h[0]._feed_title;return{title:v,link:p,description:v,image:_,item:h}}export{s as route};