import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import{cache_default as e}from"./cache-C3AIQtoX.js";import{art as t}from"./render-DE4LRFBD.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import{ofetch_default as r}from"./ofetch-DRl42yaJ.js";import{__dirname as i}from"./esm-shims-BDPl6Msv.js";import{timezone as a}from"./timezone-BrxBCotj.js";import{ViewType as o}from"./types-D9T3SQ-7.js";import s from"node:path";import{load as c}from"cheerio";const l=async o=>{let{id:l}=o.req.param(),u=Number.parseInt(o.req.query(`limit`)??`12`,10),d=`https://www.scientificamerican.com`,f=new URL(`podcast${l?`/${l}`:`s`}/`,d).href,p=await r(f),m=c(p),h=m(`html`).attr(`lang`)??`en`,g=p.match(/window\.__DATA__=JSON\.parse\(`(.*?)`\)/)?.[1],_=g?JSON.parse(g.replaceAll(`\\\\`,`\\`)):void 0,v=[];return v=_?_.initialData.props.results.slice(0,u).map(e=>{let r=e.title,o=e.image_url,c=t(s.join(i,`templates/description-161a46b8.art`),{images:o?[{src:o,alt:e.image_alt_text||r,width:e.image_width,height:e.image_height}]:void 0,intro:e.summary}),l=e.date_published,u=e.url,f=[...new Set([e.category,e.subtype,e.column,e.digital_column].filter(Boolean))],p=e.authors.map(e=>({name:e.name,url:e.url?new URL(e.url,d).href:void 0,avatar:e.picture_file})),m=`-${e.id}`,g=e.release_date??l,_={title:r,description:c,pubDate:l?a(n(l),8):void 0,link:u?new URL(u,d).href:void 0,category:f,author:p,doi:e.article_doi,guid:m,id:m,content:{html:c,text:e.summary??c},image:o,banner:o,updated:g?a(n(g),8):void 0,language:h},v=e.media_url;if(v){let e=`audio/${v.replace(/\?.*$/,``).split(/\./).pop()}`;_={..._,enclosure_url:v,enclosure_type:e,enclosure_title:r,itunes_item_image:o}}return _}):[],v=(await Promise.all(v.map(o=>o.link?e.tryGet(o.link,async()=>{let e=await r(o.link),c=e.match(/window\.__DATA__=JSON\.parse\(`(.*?)`\)/)?.[1],l=c?JSON.parse(c.replaceAll(`\\\\`,`\\`)):void 0;if(!l)return o;let u=l.initialData.article,f=u.title,p=u.image_url,m=t(s.join(i,`templates/description-161a46b8.art`),{images:p?[{src:p,alt:u.image_alt_text||f,width:u.image_width,height:u.image_height}]:void 0,intro:u.summary,content:u.content}),g=u.published_at_date_time,_=[...new Set([u.display_category,u.primary_category,u.subcategory,...u.categories??[],u.podcast_series_name])],v=u.authors.map(e=>({name:e.name,url:e.url?new URL(e.url,d).href:void 0,avatar:e.picture_file})),y=`scientificamerican-${u.id}`,b=u.updated_at_date_time??g,x={title:f,description:m,pubDate:g?a(n(g),8):void 0,category:_,author:v,doi:u.article_doi,guid:y,id:y,content:{html:m,text:u.summary??m},image:p,banner:p,updated:b?a(n(b),8):void 0,language:h},S=u.media_url;if(S){let e=`audio/${S.replace(/\?.*$/,``).split(/\./).pop()}`;x={...x,enclosure_url:S,enclosure_type:e,enclosure_title:f,itunes_item_image:p}}return{...o,...x}}):o))).filter(e=>!0),{title:m(`title`).text(),description:m(`meta[name="description"]`).attr(`content`),link:f,item:v,allowEmpty:!0,image:m(`meta[property="og:image"]`).attr(`content`),author:m(`meta[property="og:site_name"]`).attr(`content`),language:h,feedLink:m(`link[type="application/rss+xml"]`).attr(`href`),itunes_author:m(`meta[property="og:site_name"]`).attr(`content`),itunes_category:`Science`,id:m(`meta[property="og:url"]`).attr(`content`)}},u={path:`/podcast/:id?`,name:`Podcasts`,url:`www.scientificamerican.com`,maintainers:[`nczitzk`],handler:l,example:`/scientificamerican/podcast`,parameters:{id:`ID, see below`},description:":::tip\nIf you subscribe to [Science Quickly](https://www.scientificamerican.com/podcast/science-quickly/)，where the URL is `https://www.scientificamerican.com/podcast/science-quickly/`, extract the part `https://www.scientificamerican.com/podcast/` to the end, which is `science-quickly`, and use it as the parameter to fill in. Therefore, the route will be [`/scientificamerican/podcast/science-quickly`](https://rsshub.app/scientificamerican/podcast/science-quickly).\n:::\n\n| All | Science Quickly | Uncertain    |\n| --- | --------------- | ------------ |\n|     | science-quickly | science-talk |\n",categories:[`new-media`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`www.scientificamerican.com/podcasts/`,`www.scientificamerican.com/podcast/:id`],target:e=>{let t=e.id;return`/scientificamerican/podcast${t?`/${t}`:``}`}},{title:`Science Quickly`,source:[`www.scientificamerican.com/podcast/science-quickly/`],target:`/podcast/science-quickly`},{title:`Uncertain`,source:[`www.scientificamerican.com/podcast/science-talk/`],target:`/podcast/science-talk`}],view:o.Articles,zh:{path:`/podcast/:id?`,name:`Podcasts`,url:`www.scientificamerican.com`,maintainers:[`nczitzk`],handler:l,example:`/scientificamerican/podcast`,parameters:{id:`ID，见下表`},description:":::tip\n若订阅 [Science Quickly](https://www.scientificamerican.com/podcast/science-quickly/)，网址为 `https://www.scientificamerican.com/podcast/science-quickly/`，请截取 `https://www.scientificamerican.com/podcast/` 到末尾 `/` 的部分 `science-quickly` 作为 `id` 参数填入，此时目标路由为 [`/scientificamerican/podcast/science-quickly`](https://rsshub.app/scientificamerican/podcast/science-quickly)。\n:::\n\n| 全部 | Science Quickly | Uncertain    |\n| ---- | --------------- | ------------ |\n|      | science-quickly | science-talk |\n"}};export{l as handler,u as route};