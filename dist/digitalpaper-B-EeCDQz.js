import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import"./helpers-LVq640iW.js";import{cache_default as e}from"./cache-C3AIQtoX.js";import{art as t}from"./render-DE4LRFBD.js";import"./ofetch-DRl42yaJ.js";import{__dirname as n}from"./esm-shims-BDPl6Msv.js";import{got_default as r}from"./got-BaOFZRd4.js";import i from"node:path";import{load as a}from"cheerio";const o=({subtitle:e,quotation:r,pics:a,article:o})=>t(i.join(n,`templates/description-3b70807f.art`),{subtitle:e,quotation:r,pics:a,article:o}),s=async e=>{let t=await r({method:`get`,url:e}),n=a(t.data),i=n(`.right1 .bmname`).children().length;return{pageLength:i,$:n}},c=(e,t)=>{let n=e(`.zi .zi-top .banci strong`).text(),r=e(`.zi-meat ul>li`).toArray().map(r=>{let i=e(r).find(`a`).attr(`href`),a=e(r).find(`a div`).text();return{link:`${t}/${i}`,title:`[${n}] ${a}`}});return r},l=(e,t=1)=>{let n=async()=>{let n=`${e}/node_${t+1}.htm`,i=await r({method:`get`,url:n}),o=a(i.data);return c(o,e)};return n},u=async(e,t)=>{let n=await Promise.all(e.map(e=>t.tryGet(e.link,async()=>{let{data:t}=await r(e.link),n=a(t),i=n(`.right-meat .yinti`).text(),s=n(`.right-meat .futi`).text(),c=n(`.right-meat .tuwen .article #ozoom`).html(),l=n(`.right-meat .tuwen .picture`).toArray().map(e=>{let t={};return n(e).find(`tr`).toArray().map(e=>{let r=n(e).find(`img`).attr(`src`);return r?t.src=r:t.des=n(e).find(`td`).text(),null}),t});return e.author=n(`.right-meat .author`).text(),e.description=o({subtitle:s,quotation:i,article:c,pics:l}),e})));return n},d={path:`/digitalpaper`,categories:[`traditional-media`],example:`/stdaily/digitalpaper`,parameters:{},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`科技日报`,maintainers:[`lyqluis`],handler:f};async function f(){let t=new Date,n=t.toLocaleDateString(`zh-CN`,{year:`numeric`,month:`2-digit`,day:`2-digit`}),r=n.replace(`/`,`-`),i=`http://digitalpaper.stdaily.com/http_www.kjrb.com/kjrb/html/${r}`,a=[],o=[],{pageLength:d,$:f}=await s(`${i}/node_2.htm`);o.push(...c(f,i));for(let e=2;e<=d;e++)a.push(l(i,e));o.push(...(await Promise.all(a.map(e=>e()))).flat());let p=await u(o,e);return{title:`科技日报`,link:`http://digitalpaper.stdaily.com`,item:p}}export{d as route};