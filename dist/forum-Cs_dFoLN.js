import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import"./helpers-LVq640iW.js";import{art as e}from"./render-DE4LRFBD.js";import{parseDate as t}from"./parse-date-DHsdom8D.js";import"./ofetch-DRl42yaJ.js";import{__dirname as n}from"./esm-shims-BDPl6Msv.js";import{got_default as r}from"./got-BaOFZRd4.js";import{timezone as i}from"./timezone-BrxBCotj.js";import a from"node:path";import{load as o}from"cheerio";const s={path:[`/tieba/forum/good/:kw/:cid?/:sortBy?`,`/tieba/forum/:kw/:sortBy?`],categories:[`bbs`],example:`/baidu/tieba/forum/good/女图`,parameters:{kw:`吧名`,cid:"精品分类，默认为 `0`（全部分类），如果不传 `cid` 则获取全部分类",sortBy:"排序方式：`created`, `replied`。默认为 `created`"},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`精品帖子`,maintainers:[`u3u`],handler:c};async function c(s){let{kw:c,cid:l=`0`,sortBy:u=`created`}=s.req.param(),d={kw:encodeURIComponent(c)};s.req.path.includes(`good`)&&(d.tab=`good`),l&&(d.cid=l);let{data:f}=await r(`https://tieba.baidu.com/f`,{headers:{Referer:`https://tieba.baidu.com/`},searchParams:d}),p=o(f)(`code[id="pagelet_html_frs-list/pagelet/thread_list"]`).contents().filter(e=>e.nodeType===`8`),m=o(p.prevObject[0].data),h=m(`#thread_list > .j_thread_list[data-field]`).toArray().map(r=>{let o=m(r),{id:s,author_name:c}=o.data(`field`),l=u===`created`?o.find(`.is_show_create_time`).text().trim():o.find(`.threadlist_reply_date`).text().trim(),d=o.find(`a.j_th_tit`).text().trim(),f=o.find(`.threadlist_abs`).text().trim(),p=o.find(`.threadlist_media img`).toArray().map(e=>{let t=m(e);return`<img src="${t.attr(`bpic`)}">`}).join(``);return{title:d,description:e(a.join(n,`templates/forum-744e0e74.art`),{details:f,medias:p,author_name:c}),pubDate:i(t(l,[`HH:mm`,`M-D`,`YYYY-MM`],!0),8),link:`https://tieba.baidu.com/p/${s}`}});return{title:`${c}吧`,description:o(f)(`meta[name="description"]`).attr(`content`),link:`https://tieba.baidu.com/f?kw=${encodeURIComponent(c)}`,item:h}}export{s as route};