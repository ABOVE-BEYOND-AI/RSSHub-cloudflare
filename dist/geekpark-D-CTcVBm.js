import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import"./helpers-LVq640iW.js";import{cache_default as e}from"./cache-C3AIQtoX.js";import{art as t}from"./render-DE4LRFBD.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import"./ofetch-DRl42yaJ.js";import{__dirname as r}from"./esm-shims-BDPl6Msv.js";import{got_default as i}from"./got-BaOFZRd4.js";import a from"node:path";import{load as o}from"cheerio";const s=async s=>{let{column:c}=s.req.param(),l=s.req.query(`limit`)?Number.parseInt(s.req.query(`limit`),10):20,u=`https://geekpark.net`,d=`https://mainssl.geekpark.net`,f=new URL(c?`column/${c}`:``,u).href,p=new URL(c?`api/v1/columns/${c}`:`api/v2`,d).href,{data:m}=await i(p),h=(m.homepage_posts??m.column.posts).slice(0,l).map(e=>{e=e.post??e;let i=e.title,o=e.cover_url,s=t(a.join(r,`templates/description-881baa33.art`),{image:o?[{src:o,alt:i}]:void 0,intro:e.abstract}),c=`geekpark-${e.id}`;return{title:i,description:s,pubDate:n(e.published_timestamp,`X`),link:new URL(`api/v1/posts/${e.id}`,d).href,category:[...new Set([...e.tags,e.column?.title])].filter(Boolean),author:e.authors.map(e=>e.realname??e.nickname).join(`/`),guid:c,id:c,content:{html:s,text:e.abstract},image:o,banner:o}});h=await Promise.all(h.map(o=>e.tryGet(o.link,async()=>{let{data:e}=await i(o.link),s=e.post,c=s.title,l=s.cover_url,d=t(a.join(r,`templates/description-881baa33.art`),{image:l?[{src:l,alt:c}]:void 0,intro:s.abstract,description:s.content}),f=`geekpark-${s.id}`;return o.title=c,o.description=d,o.pubDate=n(s.published_timestamp,`X`),o.link=new URL(`news/${s.id}`,u).href,o.category=[...new Set([...s.tags,s.column?.title])].filter(Boolean),o.author=s.authors.map(e=>e.realname??e.nickname).join(`/`),o.guid=f,o.id=f,o.content={html:d,text:s.content},o.image=l,o.banner=l,o.updated=n(s.updated_at),o})));let g={title:``,description:``,link:f,item:h,allowEmpty:!0,image:``,author:``};if(c)g.title=`${m.column.title} | 极客公园`,g.description=m.column.description,g.image=m.column.banner_url;else{let{data:e}=await i(f),t=o(e);g.title=t(`title`).text(),g.description=t(`meta[property="og:description"]`).prop(`content`),g.image=`https:${t(`meta[name="og:image"]`).prop(`content`)}`,g.author=t(`meta[property="og:site_name"]`).prop(`content`)}return g},c={path:`/:column?`,name:`栏目`,url:`geekpark.net`,maintainers:[`nczitzk`],handler:s,example:`/geekpark`,parameters:{column:`栏目 id，默认为空，即首页资讯，可在对应栏目页 URL 中找到`},description:`::: tip
  若订阅 [综合报道](https://www.geekpark.net/column/179)，网址为 \`https://www.geekpark.net/column/179\`。截取 \`https://www.geekpark.net/column/\` 到末尾的部分 \`179\` 作为参数填入，此时路由为 [\`/geekpark/179\`](https://rsshub.app/geekpark/179)。
:::

| 栏目                                                         | ID                                     |
| ------------------------------------------------------------ | -------------------------------------- |
| [综合报道](https://www.geekpark.net/column/179)              | [179](https://rsshub.app/geekpark/179) |
| [AI新浪潮观察](https://www.geekpark.net/column/304)          | [304](https://rsshub.app/geekpark/304) |
| [新造车观察](https://www.geekpark.net/column/305)            | [305](https://rsshub.app/geekpark/305) |
| [财报解读](https://www.geekpark.net/column/271)              | [271](https://rsshub.app/geekpark/271) |
| [底稿对话CEO系列](https://www.geekpark.net/column/308)       | [308](https://rsshub.app/geekpark/308) |
| [Geek Insight 特稿系列](https://www.geekpark.net/column/306) | [306](https://rsshub.app/geekpark/306) |
| [心科技](https://www.geekpark.net/column/307)                | [307](https://rsshub.app/geekpark/307) |
| [行业资讯](https://www.geekpark.net/column/2)                | [2](https://rsshub.app/geekpark/2)     |
  `,categories:[`new-media`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`geekpark.net`],target:`/`},{source:[`geekpark.net/column/:column?`],target:e=>{let t=e.column;return t?`/${t}`:``}},{title:`综合报道`,source:[`www.geekpark.net/column/179`],target:`/179`},{title:`AI新浪潮观察`,source:[`www.geekpark.net/column/304`],target:`/304`},{title:`新造车观察`,source:[`www.geekpark.net/column/305`],target:`/305`},{title:`财报解读`,source:[`www.geekpark.net/column/271`],target:`/271`},{title:`底稿对话CEO系列`,source:[`www.geekpark.net/column/308`],target:`/308`},{title:`Geek Insight 特稿系列`,source:[`www.geekpark.net/column/306`],target:`/306`},{title:`心科技`,source:[`www.geekpark.net/column/307`],target:`/307`},{title:`行业资讯`,source:[`www.geekpark.net/column/2`],target:`/2`}]};export{s as handler,c as route};