import{art as e}from"./render-DE4LRFBD.js";import{parseDate as t}from"./parse-date-DHsdom8D.js";import{__dirname as n}from"./esm-shims-BDPl6Msv.js";import{got_default as r}from"./got-BaOFZRd4.js";import i from"node:path";import a from"dayjs";import{load as o}from"cheerio";import{JSDOM as s}from"jsdom";import c from"dayjs/plugin/localizedFormat.js";import"dayjs/locale/zh-cn.js";a.extend(c);function l(e){let t={};try{let n=new s(e,{runScripts:`dangerously`});t=n.window.__NUXT__.data[0]}catch{throw Error(`Nuxt 框架信息提取失败，请报告这个问题`)}return t}function u(e){return`<img src="${e}"><br/>`}async function d(e){let t=await r(e),n=t.data,i=o(n),a=i(`.description`).html();return{content:a}}async function f(e){let n=await r(e),i=n.data,a=o(i),s=a(`.detail-body-container`).html(),c=a(`.topics-articleHead__date`).text();return s=s.replaceAll(`src="/topics/`,`src="https://www.nintendo.com.hk/topics/`),{content:s,pubDate:t(c,`YYYY.M.D`)}}const p=(e,t)=>Promise.all(e.map(async e=>{let n=await t.tryGet(e.link,()=>d(e.link));return{...e,...n}})),m=(e,t)=>Promise.all(e.map(async e=>{let n=await t.tryGet(e.url,()=>f(`https://www.nintendo.com.hk`+e.url));return{...e,...n}})),h=(t,o)=>Promise.all(t.map(async t=>{if(!t.link.startsWith(`https://www.nintendoswitch.com.cn/software/`))return t;let s=await o.tryGet(t.link,async()=>l((await r(t.link)).data)),c=s.data;return{...t,category:[...c.supportLanguages,...c.genre,...c.playMode],description:e(i.join(n,`templates/eshop_cn-23aed242.art`),{item:t,software:c,releaseDatetime:a(c.releaseDatetime).locale(`zh-cn`).format(`lll`)})}})),g=(e,n)=>Promise.all(e.map(async e=>{let i=await n.tryGet(e.link,async()=>l((await r(e.link)).data));return{...e,description:e.description+i.newsData.content,category:i.newsData.category,pubDate:t(i.newsData.releaseTime,`x`)}}));var _={ProcessItem:p,ProcessNews:m,ProcessNewsChina:g,ProcessItemChina:h,nuxtReader:l,generateImageLink:u};export{_ as utils_default};