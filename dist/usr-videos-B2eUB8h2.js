import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import"./helpers-LVq640iW.js";import{art as e}from"./render-DE4LRFBD.js";import{parseDate as t}from"./parse-date-DHsdom8D.js";import"./ofetch-DRl42yaJ.js";import{__dirname as n}from"./esm-shims-BDPl6Msv.js";import{got_default as r}from"./got-BaOFZRd4.js";import{ViewType as i}from"./types-D9T3SQ-7.js";import a from"node:path";const o={path:`/user/:username/:cat?`,categories:[`social-media`],view:i.Videos,example:`/vimeo/user/filmsupply/picks`,parameters:{username:"In this example [https://vimeo.com/filmsupply](https://vimeo.com/filmsupply)  is `filmsupply`",cat:"deafult for all latest videos, others categories in this example such as `Docmentary`, `Narrative`, `Drama`. Set `picks` for promote orders, just orderd like web page. When `picks` added, published date won't show up"},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`User Profile`,maintainers:[`MisteryMonster`],handler:s,description:"::: tip Special category name attention\n  Some of the categories contain slash like `3D/CG` , must change the slash `/` to the vertical bar`|`.\n:::"};async function s(i){let o=await r({method:`get`,url:`https://vimeo.com/_rv/viewer`}),s=o.data.jwt,{username:c,cat:l}=i.req.param(),u=await r({method:`get`,url:`https://api.vimeo.com/users/${c}?fields=name,gender,bio,uri,link,categories&fetch_user_profile=1`,headers:{Authorization:`jwt ${s}`}}),d=u.data,f=u.data.categories,p;if(l&&f.length>0)for(let e of f)decodeURIComponent(l).replaceAll(`|`,`/`)===e.name&&(p=e.word);let m=`&filter=category&filter_category=${p}`;if(l||(m=``),!p&&l&&l!==`picks`)return``;let h=l&&l===`picks`,g=`${d.uri}/videos?fields=name,uri,description,created_time&include_videos=1&page=1&per_page=10${m}`,_=`/users/${c}/profile_sections?fields=videos.data.clip.name,videos.data.clip.uri,videos.data.clip.description,videos.data.clip.created_time&include_videos=1&badge=1&page=1&per_page=10`,v=await r({method:`get`,url:`https://api.vimeo.com${h?_:g}`,headers:{Authorization:`jwt ${s}`}}),y=h?v.data.data[0].videos.data:v.data.data;return{title:`${d.name} ${p?l.replace(`|`,`/`):``} ${h?`picks`:``} | Vimeo `,link:d.link,description:d.bio,item:y.map(r=>{let i=h?r.clip.description:r.description;return{title:h?r.clip.name:r.name,description:e(a.join(n,`templates/description-f7979603.art`),{videoUrl:h?r.clip.uri.replace(`/videos`,``):r.uri.replace(`/videos`,``),vdescription:i?i.replaceAll(`
`,`<br>`):``}),pubDate:t(h||l?``:r.created_time),link:`https://vimeo.com${h?r.clip.uri.replace(`videos/`,``):r.uri.replace(`videos/`,``)}`,author:d.name}})}}export{o as route};