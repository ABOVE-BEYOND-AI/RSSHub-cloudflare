import"./config-HRWLmo66.js";import{logger_default as e}from"./logger-DHpG8Bim.js";import"./proxy-BQXcrhTu.js";import{art as t}from"./render-DE4LRFBD.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import{__dirname as r}from"./esm-shims-BDPl6Msv.js";import{puppeteer_default as i}from"./puppeteer-BAoY_Fpy.js";import a from"node:path";import{load as o}from"cheerio";const s={name:`漏洞`,categories:[`programming`],path:`/zeroday/vulnerability/:status?`,example:`/hitcon/zeroday/vulnerability`,parameters:{status:`漏洞状态，见下表`},maintainers:[`KarasuShin`],radar:[{source:[`zeroday.hitcon.org/vulnerability/:status?`]}],features:{requirePuppeteer:!0},handler:l,description:`| 缺省   | all  | closed | disclosed | patching |
| ------ | ---- | ------ | --------- | -------- |
| 活動中 | 全部 | 關閉   | 公開      | 修補中   |`},c={all:`全部`,closed:`關閉`,disclosed:`公開`,patching:`修補中`};async function l(s){let l=`https://zeroday.hitcon.org/vulnerability`,u=s.req.param(`status`);u&&(l+=`/${u}`);let d=await i(),f=await d.newPage();await f.setRequestInterception(!0),f.on(`request`,e=>{e.resourceType()===`document`?e.continue():e.abort()}),e.http(`Requesting ${l}`),await f.goto(l,{waitUntil:`domcontentloaded`});let p=await f.evaluate(()=>document.documentElement.innerHTML);await d.close();let m=o(p),h=m(`.zdui-strip-list>li`).toArray().map(e=>{let i=m(e).find(`.title a`),o=m(e).find(`.vul-data`),s=o.find(`.code`).contents().filter(function(){return this.nodeType===3}).text(),c=o.find(`.risk span`).eq(1).text(),l=o.find(`.vender`).find(`.v-name-full`).text(),u=o.find(`.status`).text().replace(`Status:`,``).trim(),d=o.find(`.date`).text().replace(`Date:`,``).trim(),f=o.find(`.zdui-author-badge`).find(`a>span`).text(),p=t(a.join(r,`templates/zeroday-08cb6861.art`),{code:s,risk:c,vender:l,status:u,date:d,reporter:f});return{title:i.text(),link:i.attr(`href`),description:p,pubDate:n(d)}});return{title:u?c[u]??`ZeroDay`:`活動中`,link:l,item:h,image:`https://zeroday.hitcon.org/images/favicon/favicon.png`}}export{s as route};