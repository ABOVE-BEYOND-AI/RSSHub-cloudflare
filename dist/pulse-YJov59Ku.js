import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import"./helpers-LVq640iW.js";import{art as e}from"./render-DE4LRFBD.js";import{parseDate as t}from"./parse-date-DHsdom8D.js";import{md5 as n}from"./md5-15Cn4YyR.js";import"./ofetch-DRl42yaJ.js";import{__dirname as r}from"./esm-shims-BDPl6Msv.js";import{got_default as i}from"./got-BaOFZRd4.js";import a from"node:path";import{load as o}from"cheerio";const s={path:`/pulse/:user/:repo/:period?`,categories:[`programming`],example:`/github/pulse/DIYgod/RSSHub`,parameters:{user:`User name`,repo:`Repo name`,period:"Time frame, selected from a repository's Pulse/Insights page. Possible values are: `daily`, `halfweekly`, `weekly`, or `monthly`. Default: `weekly`. If your RSS client supports it, consider aligning the polling frequency of the feed to the period."},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`github.com/:user/:repo/pulse`,`github.com/:user/:repo/pulse/:period`]}],name:`Repo Pulse`,maintainers:[`jameschensmith`],handler:c};async function c(s){let{user:c,repo:l,period:u}=s.req.param(),d=[`daily`,`halfweekly`,`weekly`,`monthly`],f=d.includes(u)?u:d[2],p=`https://github.com/${c}/${l}/pulse/${f}`,{data:m}=await i(p),h=o(m),g=h(`main .Layout-main`).children(),_=g.eq(0),[v,y]=_.find(`h2`).text().split(`â€“`),b=g.eq(1),x=b.find(`ul ul li`).toArray().map(e=>h(e).text()),S=g.eq(2),C,w=S.find(`.js-pulse-contribution-data`);if(w.length){let e=w.attr(`data-pulse-diffstat-summary-url`);C=(await i(`https://github.com${e}`)).data}else C=S.text();let T=g.eq(3),E,D=T.find(`h3`);return D.length&&(E=D.toArray().map(e=>{let t=h(e),n=t.nextUntil(`h3`),r=t.nextUntil(`ul`),i=n.last();return{heading:t.text(),paragraph:r.length>0?r.text():void 0,items:i.children().toArray().map(e=>{let t=h(e),n=t.find(`a`),r=t.find(`p`),i=r.find(`relative-time`);return i.replaceWith(i.attr(`datetime`)),{link:{text:n.text(),url:n.attr(`href`)},details:r.text()}})}})),{title:`${c}/${l} ${f} Pulse`,link:p,item:[{guid:n(`${c}${l}${u}${v}${y}`),title:`${v} - ${y}`,description:e(a.join(r,`templates/pulse-description-eccd13db.art`),{overviewItems:x,commitActivity:C,githubActivity:E}),pubDate:t(y)}]}}export{s as route};