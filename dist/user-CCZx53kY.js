import{config as e}from"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import"./helpers-LVq640iW.js";import{cache_default as t}from"./cache-C3AIQtoX.js";import{art as n}from"./render-DE4LRFBD.js";import{parseDate as r}from"./parse-date-DHsdom8D.js";import"./ofetch-DRl42yaJ.js";import{__dirname as i}from"./esm-shims-BDPl6Msv.js";import{got_default as a}from"./got-BaOFZRd4.js";import o from"node:path";const s={path:`/:handle`,categories:[`picture`],example:`/artstation/wlop`,parameters:{handle:`Artist handle, can be found in URL`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`www.artstation.com/:handle`]}],name:`Artist Profolio`,maintainers:[`TonyRL`],handler:c};async function c(s){let c=s.req.param(`handle`),l={accept:`application/json, text/plain, */*`,"accept-language":`en-US,en;q=0.9`,"content-type":`application/json`,"user-agent":e.trueUA},u=await t.tryGet(`artstation:csrfToken`,async()=>{let e=await a.post(`https://www.artstation.com/api/v2/csrf_protection/token.json`,{headers:l});return e.headers[`set-cookie`][0].split(`;`)[0].split(`=`)[1]}),{data:d}=await a(`https://www.artstation.com/users/${c}/quick.json`,{headers:{...l,cookie:`PRIVATE-CSRF-TOKEN=${u}`}}),{data:f}=await a(`https://www.artstation.com/users/${c}/projects.json`,{headers:{...l,cookie:`PRIVATE-CSRF-TOKEN=${u}`},searchParams:{user_id:d.id,page:1}}),p=e=>e.replace(/\/\d{14}\/small_square\//,`/large/`),m=f.data.map(e=>({title:e.title,description:n(o.join(i,`templates/description-674eb99b.art`),{description:e.description,image:{src:p(e.cover.small_square_url),title:e.title}}),pubDate:r(e.published_at),updated:r(e.updated_at),link:e.permalink,author:d.full_name,assetsCount:e.assets_count,hashId:e.hash_id,icons:e.icons})),h=await Promise.all(m.map(e=>t.tryGet(e.link,async()=>{if(e.assetsCount>1||!e.icons.image){let{data:t}=await a(`https://www.artstation.com/projects/${e.hashId}.json`,{headers:{...l,cookie:`PRIVATE-CSRF-TOKEN=${u}`}});e.description=n(o.join(i,`templates/description-674eb99b.art`),{description:t.description,assets:t.assets});for(let e of t.assets)if(e.asset_type!==`video`&&e.asset_type!==`image`&&e.asset_type!==`video_clip`&&e.asset_type!==`cover`)throw Error(`Unhandle asset type: ${e.asset_type}`)}return e})));return{title:`${d.full_name} - ArtStation`,description:d.headline,link:d.permalink,logo:d.large_avatar_url,icon:d.large_avatar_url,image:d.default_cover_url,item:h}}export{s as route};