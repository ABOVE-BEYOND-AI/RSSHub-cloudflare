import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import"./helpers-LVq640iW.js";import{art as e}from"./render-DE4LRFBD.js";import{parseDate as t}from"./parse-date-DHsdom8D.js";import"./ofetch-DRl42yaJ.js";import{__dirname as n}from"./esm-shims-BDPl6Msv.js";import{got_default as r}from"./got-BaOFZRd4.js";import{timezone as i}from"./timezone-BrxBCotj.js";import a from"node:path";import{load as o}from"cheerio";import s from"markdown-it";const c=s({html:!0}),l={1:0,2:2,3:1},u={path:[`/exclusive/:locale?`,`/news/:locale?`,`/:locale?`,`/:type/:id/:locale?`],categories:[`new-media`],example:`/farmatters/exclusive`,parameters:{locale:"Locale, `zh-CN` or `en-US`, `zh-CN` by default"},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`farmatters.com/exclusive`],target:`/exclusive`}],name:`Exclusive`,maintainers:[`nczitzk`],handler:d,url:`farmatters.com/news`};async function d(s){let{type:u,id:d,locale:f=`zh-CN`}=s.req.param(),p=s.req.query(`limit`)?Number.parseInt(s.req.query(`limit`),10):50,m={locale:f,page:0,pagesize:p};u===`wiki`&&d?m.subCatalogId=d:u&&d&&(m[u]=d);let h=`https://farmatters.com`,g=new URL(`api/v1/doc/list`,h).href,_=new URL(`${f===`zh-CN`?``:`en/`}${u?u===`wiki`?`wiki`:`tag/${d}`:`news`}`,h).href,{data:v}=await r(g,{searchParams:m,https:{rejectUnauthorized:!1}}),y=v.data.list.slice(0,p).map(r=>({title:r.title,link:new URL(`doc/${r.id}`,h).href,description:e(a.join(n,`templates/description-dcf20f08.art`),{image:r.headImageUrl?{src:r.headImageUrl,alt:r.title}:void 0,description:c.render(r.content??r.summary)}),author:r.author,category:[r.catalogName,r.subCatalogName??void 0,...r.tags?.map(e=>e.tagName)??[]].filter(Boolean),guid:`farmatters-${r.id}`,pubDate:i(t(r.createdAt),8)})),{data:b}=await r(_,{https:{rejectUnauthorized:!1}}),x=o(b),S=`${x(`h4`).first().text()}${u===`wiki`?` - ${x(`div.css-6f6728 div.MuiBox-root`).eq(l[d]).text()}`:``}`,C=new URL(`favicon.ico`,h).href;return{item:y,title:`${x(`title`).text().split(/-/)[0].trim()} - ${S}`,link:_,description:x(`meta[name="description"]`).prop(`content`),language:x(`html`).prop(`lang`),image:new URL(x(`img`).first().prop(`src`),h).href,icon:C,logo:C,subtitle:S,allowEmpty:!0}}export{u as route};