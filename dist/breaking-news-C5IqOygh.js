import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import"./helpers-LVq640iW.js";import{cache_default as e}from"./cache-C3AIQtoX.js";import{art as t}from"./render-DE4LRFBD.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import"./ofetch-DRl42yaJ.js";import{__dirname as r}from"./esm-shims-BDPl6Msv.js";import{got_default as i}from"./got-BaOFZRd4.js";import{timezone as a}from"./timezone-BrxBCotj.js";import o from"node:path";import{load as s}from"cheerio";const c={path:`/news/breakingnews/:id`,categories:[`traditional-media`],example:`/udn/news/breakingnews/99`,parameters:{id:`类别`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`udn.com/news/breaknews/1/:id`,`udn.com/`]}],name:`即時新聞`,maintainers:[`miles170`],handler:l,description:`| 0    | 1    | 2    | 3    | 4    | 5    | 6    | 7    | 8    | 9    | 11   | 12   | 13   | 99     |
| ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ------ |
| 精選 | 要聞 | 社會 | 地方 | 兩岸 | 國際 | 財經 | 運動 | 娛樂 | 生活 | 股市 | 文教 | 數位 | 不分類 |`};async function l(c){let l=c.req.param(`id`),d=`/news/breaknews/1/${l}#breaknews`,f=await u(d),p=`https://udn.com`,m=await i(`${p}/api/more?page=1&channelId=1&cate_id=${l}&type=breaknews`),h=await Promise.all(m.data.lists.map(c=>{let l=c.titleLink.startsWith(`http`)?c.titleLink:`${p}${c.titleLink}`,u=new URL(l);return u.query=u.search=``,l=u.toString(),e.tryGet(l,async()=>{let e=await i(l),u=e.data.match(/<script language=javascript>window\.location\.href="(https?:\/\/[^"]+)"/);u&&(e=await i(u[1]));let d=s(e.data),f=d(`script[type="application/ld+json"]`).eq(0).text().trim().replaceAll(/[\b\t\n]/g,``),p=f.startsWith(`[`)?JSON.parse(f)[0]:JSON.parse(f),m=d(`.article-content__editor`),h=d(`.article-body__editor`),g=``;return p.image&&(g+=t(o.join(r,`templates/figure-a45dec39.art`),{src:p.image.contentUrl,alt:p.image.name})),m.length?g+=m.html():h.length&&(g+=h.html()),p.publisher.name.includes(`轉角國際 udn Global`)&&(g=d(`.story_body_content`).html().split(/<!--\d+?-->/g).slice(1,-1).join(``)),{title:c.title,author:[{name:d(`.article-content__author`).text().match(`中央社`)?.at(0)},{name:p.publisher.name.match(`轉角國際 udn Global`)?.at(0)},p.author].filter(e=>!!e.name),description:g,pubDate:a(n(c.time.date,`YYYY-MM-DD HH:mm`),8),category:[p.articleSection,u?d(`.article-head li.breadcrumb__item:last > b`).text():d(`meta[name='subsection']`).attr(`content`),...p.keywords.split(`,`)],link:l}})}));return{title:`即時${f} - 聯合新聞網`,link:`${p}${d}`,description:`udn.com 提供即時新聞以及豐富的政治、社會、地方、兩岸、國際、財經、數位、運動、NBA、娛樂、生活、健康、旅遊新聞，以最即時、多元的內容，滿足行動世代的需求`,item:h}}const u=async t=>{let n=`https://udn.com/news/breaknews`,r=await e.tryGet(n,async()=>{let e=await i(n),t=s(e.data),r=t(`.cate-list__subheader a`).toArray().map(e=>(e=t(e),[e.attr(`href`),e.text().trim()]));return Object.fromEntries(r)});return t in r?r[t]:`列表`};export{c as route};