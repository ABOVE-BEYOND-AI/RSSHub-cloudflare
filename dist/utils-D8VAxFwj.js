import{cache_default as e}from"./cache-C3AIQtoX.js";import{art as t}from"./render-DE4LRFBD.js";import{__dirname as n}from"./esm-shims-BDPl6Msv.js";import{got_default as r}from"./got-BaOFZRd4.js";import i from"node:path";import{load as a}from"cheerio";const o=(e,t)=>{switch(e){case`Image`:switch(t){case`sq`:return`Fotografi`;case`am`:return`ምስል`;case`ar`:return`صورة من`;case`bn`:return`ছবি`;case`bs`:return`Foto`;case`bg`:return`Снимка`;case`zh`:return`图像来源`;case`zh-hant`:return`圖片來源`;case`hr`:return`Foto`;case`fa-af`:return`عکس`;case`en`:return`Image`;case`fr`:return`Image`;case`de`:return`Bild`;case`el`:return`Εικόνα`;case`ha`:return`Hoto`;case`hi`:return`तस्वीर`;case`id`:return`Foto`;case`sw`:return`Picha`;case`mk`:return`Фотографија`;case`ps`:return`انځور`;case`fa-ir`:return`عکس`;case`pl`:return`Zdjęcie`;case`pt-002`:return`Foto`;case`pt-br`:return`Foto`;case`ro`:return`Imagine`;case`ru`:return`Фото`;case`sr`:return`Foto`;case`es`:return`Imagen`;case`tr`:return`Fotoğraf`;case`uk`:return`Фото`;case`ur`:return`تصویر`;default:return`Image`}default:return e}},s=e=>e.replace(`https://hlsvod.dw.com/i/`,`https://tvdownloaddw-a.akamaihd.net/`).replace(`,AVC_480x270,AVC_512x288,AVC_640x360,AVC_960x540,AVC_1280x720,AVC_1920x1080,.mp4.csmil/master.m3u8`,`AVC_1920x1080.mp4`),c=(e,t)=>{e(`img`).each((n,r)=>{try{let n=e(r).attr(`data-id`),i=t.find(e=>String(e.targetId)===n);e(r).attr({title:i?.name,alt:i?.description,src:`https://static.dw.com/image/${n}_605.jpg`}),e(r).removeAttr(`style`)}catch{}}),e(`video`).each((t,n)=>{try{e(n).attr(`poster`,e(n).attr(`data-posterurl`))}catch{}}),e(`iframe`).each((t,n)=>{try{e(n).attr(`src`,e(n).attr(`data-src`))}catch{}}),e(`svg`).remove()},l=(e,r)=>{let l=a(r.text);c(l,r.contentLinks);let u=e.type===`liveblog`&&r.posts?t(i.join(n,`templates/liveblog-f70e0cdd.art`),{posts:r.posts.map(e=>{let t=a(e.text);return c(t,r.contentLinks),e.text=t.html(),e})}):void 0,d=e.type===`video`&&r.hlsVideoSrc?t(i.join(n,`templates/video-18fbf441.art`),{hlsVideoSrc:r.hlsVideoSrc,mp4VideoSrc:s(r.hlsVideoSrc),posterImageUrl:r.posterImageUrl}):void 0;return e.description=t(i.join(n,`templates/description-0eba44e3.art`),{teaser:r.teaser,video:d,mainImage:l(`[data-id="${r.mainContentImageLink?.targetId}"]`).length===0?r.mainContentImageLink:void 0,text:l.html(),liveblog:u,imageI18n:o(`Image`,e.language),formatId:`605`}),r.trackingCategories&&(e.category=r.trackingCategories),r.firstPersonArray&&(e.author=r.firstPersonArray.map(e=>e.fullName).join(`, `)),e},u=async t=>(t=await Promise.all(t.map(t=>e.tryGet(t.link,async()=>{let e=await r(`https://www.dw.com/graph-api/${t.language}/content/${t.type}/${t.id}`),n=e.data.data.content;return l(t,n)}))),t);export{u as processItems};