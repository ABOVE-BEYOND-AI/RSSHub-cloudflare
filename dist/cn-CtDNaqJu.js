import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import"./helpers-LVq640iW.js";import{cache_default as e}from"./cache-C3AIQtoX.js";import{art as t}from"./render-DE4LRFBD.js";import"./ofetch-DRl42yaJ.js";import{__dirname as n}from"./esm-shims-BDPl6Msv.js";import{got_default as r}from"./got-BaOFZRd4.js";import i from"node:path";import a from"node:crypto";const o={LINE_BREAK:0,INLINE_CODE:1,LEGACY_PUBLISHING_EMPHASIS:2,LIST_ITEM:3,LIST:4,STRIKETHROUGH:5,SUBSCRIPT:6,SUPERSCRIPT:7,UNDERLINE:8,BOLD:9,ITALIC:10,PARAGRAPH:11};var s=class{constructor(e){this.attr=e,this.start=e.start,this.end=e.start+e.length,this.children=[]}},c=class e{constructor(e){if(Array.isArray(e))this.string=null,this.codePoints=e;else{this.string=e;let t=e.length,n=[],r,i,a=0;for(;a<t;)r=e.charCodeAt(a++),r>=55296&&r<=56319&&a<t?(i=e.charCodeAt(a++),(64512&i)==56320?n.push(((1023&r)<<10)+(1023&i)+65536):(n.push(r),a--)):n.push(r);this.codePoints=n}this.length=this.codePoints.length}substring(t,n){let r=this.length,i=t,a=n;return a===0?new e(``):((Number.isNaN(i)||0>i)&&(i=0),(Number.isNaN(a)||0>a)&&(a=r),i>r&&(i=r),a>r&&(a=r),a<i&&(r=[i,a],a=r[0],i=r[1]),new e(i===a?``:this.codePoints.slice(i,a)))}slice(e,t){return this.substring(e,t).toString()}toString(){return this.string===null?this.codePoints.map(e=>{let t=``;return 65535<e&&(t+=String.fromCharCode((e-=65536)>>>10&1023|55296),e=1023&(56320|e)),t+String.fromCharCode(e)}).join(``):this.string}};const l=e=>{let t=e?.attr?.detailData?.style;switch(t){case`BOLD`:return`<b>${e.text}</b>`;case`LINE_BREAK`:return`<br>`;case`LIST_ITEM`:return`<li>${e.text}</li>`;case`LIST`:return`<ul>${e.text}</ul>`;case`INLINE_CODE`:return`<code>${e.text}</code>`;case`LEGACY_PUBLISHING_EMPHASIS`:return`<em>${e.text}</em>`;case`STRIKETHROUGH`:return`<s>${e.text}</s>`;case`SUBSCRIPT`:return`<sub>${e.text}</sub>`;case`SUPERSCRIPT`:return`<sup>${e.text}</sup>`;case`UNDERLINE`:return`<u>${e.text}</u>`;case`ITALIC`:return`<i>${e.text}</i>`;case`PARAGRAPH`:return`<p>${e.text}</p>`;default:return e.text||e}},u=e=>{let{attributes:t,text:n}=e,r=[...t];r.sort((e,t)=>{let n=e.start+e.length,r=t.start+t.length;return n===r?o[e.detailData.style]-o[t.detailData.style]:n-r});let i=[];for(let e of r){let t=new s(e),n=e.start;for(;0<i.length&&i.at(-1).attr.start>=n;)t.children.push(i.pop());t.children.reverse(),i.push(t)}let a=new c(n),u=e=>{if(e.children.length===0)return e.text=a.slice(e.start,e.end),l(e);let t=[],n=e.start;for(let r of e.children)n<r.start&&t.push(a.slice(n,r.start)),n=r.end,t.push(u(r));return n<e.end&&t.push(a.slice(n,e.end)),e.text=t.join(``),l(e)},d=[],f=0;for(let e of i)e.start>f&&d.push(a.slice(f,e.start)),f=e.end,d.push(u(e));return f<a.length&&d.push(a.slice(f)),d.join(``)},d=`https://www.linkedin.cn/karpos/api/graphql`,f=()=>{let e=a.randomBytes(8).toString(`hex`).slice(0,8),t={Accept:`*/*`,Cookie:`JSESSIONID="ajax:${e}"`,"Content-Type":`application/x-www-form-urlencoded`,Referer:`https://www.linkedin.cn/incareer/jobs/search`,"csrf-token":`ajax:${e}`,"x-http-method-override":`GET`,"x-restli-protocol-version":`2.0.0`};return t},p={1:`r86400`,7:`r604800`,30:`r2592000`},m={china:`102890883`,shanghai:`102772228`,beijing:`103873152`},h=e=>`(`+Object.entries(e).filter(([,e])=>e).map(([e,t])=>`${e}:${encodeURIComponent(t)}`).join(`,`)+`)`,g=e=>{let t=``;for(let[n,[r,i]]of Object.entries(e).entries())t+=`${r}=${i}`,n<Object.keys(e).length-1&&(t+=`&`);return t},_=e=>{let t=e.req.param(`keywords`),{geo:n,remote:r,location:i,period:a,relevant:o}=e.req.query(),s=i||n||`China`,c=r?`远程`:``,l=a?`近${a}天`:``,u=o?`相关`:`最新`;return`${u}${l}在${s}的${t||``}${c}工作机会`},v=async e=>{let t={origin:`jserp`,isForRemoteJobsPage:!!e.req.query(`remote`),isChinaMultiNationalCorporation:!1,count:e.req.query(`limit`)||20,start:`0`,geoUrn:`urn:li:ks_geo:${m[e.req.query(`location`)]||e.req.query(`geo`)||m.china}`,keywords:decodeURIComponent(e.req.param(`keywords`)||``),f_TPR:p[e.req.query(`period`)]||``,sortType:e.req.query(`relevant`)?``:`DATE_DESCENDING`},n=await r.post(d,{headers:f(),body:g({operationName:`searchSearchHitsByJob`,variables:h(t),queryId:`searchSearchHitsByJob.be362cd720abd0ebf89b4bbc3253047f`})});return{jobs:n.data.data.searchSearchHitsByJob.elements.map(e=>e.target.jobPosting),title:_(e)}},y=(a,o)=>{let s=o.entityUrn;return e.tryGet(`linkedincn:${s}`,async()=>{let e=await r.post(d,{headers:f(),body:g({operationName:`jobViewPage`,variables:h({jobPostingUrn:s}),queryId:`jobsJobPostingsById.3b9573e88687a86607ddb74ff013ef50`})}),a=e.data.data.jobsJobPostingsById;return a.desc=u(a.description),{title:`${o.companyName} 正在找 ${o.title}`,link:`https://www.linkedin.cn/incareer/jobs/view/${s.split(`:`).pop()}`,guid:`linkedincn:${s}`,description:t(i.join(n,`templates/posting-58123dba.art`),a),pubDate:o.listedAt}})},b={path:`/cn/jobs/:keywords?`,categories:[`other`],example:`/linkedin/cn/jobs/Software`,parameters:{keywords:`搜索关键字`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`Jobs`,maintainers:[`bigfei`],handler:x,description:"另外，可以通过添加额外的以下 query 参数来输出满足特定要求的工作职位：\n\n| 参数       | 描述                                              | 举例                                                    | 默认值  |\n| ---------- | ------------------------------------------------- | ------------------------------------------------------- | ------- |\n| `geo`      | geo 编码                                          | 102890883（中国）、102772228（上海）、103873152（北京） | 空      |\n| `remote`   | 是否只显示远程工作                                | `true/false`                                            | `false` |\n| `location` | 工作地点                                          | `china/shanghai/beijing`                                | 空      |\n| `relevant` | 排序方式 (true: 按相关性排序，false： 按日期排序) | `true/false`                                            | `false` |\n| `period`   | 发布时间                                          | `1/7/30`                                                | 空      |\n\n  例如：\n  [`/linkedin/cn/jobs/Software?location=shanghai&period=1`](https://rsshub.app/linkedin/cn/jobs/Software?location=shanghai&period=1): 查找所有在上海的今日发布的所有 Software 工作\n\n  **为了方便起见，建议您在 [LinkedIn.cn](https://www.linkedin.cn/incareer/jobs/search) 上进行搜索，并使用 [RSSHub Radar](https://github.com/DIYgod/RSSHub-Radar) 加载特定的 feed。**"};async function x(e){let{title:t,jobs:n}=await v(e),r=await Promise.all(n.map(t=>y(e,t)));return{title:`领英 - ${t}`,link:`https://www.linkedin.cn/incareer/jobs/search`,item:r}}export{b as route};