import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import"./helpers-LVq640iW.js";import{cache_default as e}from"./cache-C3AIQtoX.js";import{art as t}from"./render-DE4LRFBD.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import"./ofetch-DRl42yaJ.js";import{__dirname as r}from"./esm-shims-BDPl6Msv.js";import{got_default as i}from"./got-BaOFZRd4.js";import a from"node:path";import{load as o}from"cheerio";const s={zhengce:`政策`,fenxishishuo:`行情`,defi:`DeFi`,kuang:`矿业`,"以太坊2.0":`以太坊 2.0`,industry:`产业`,IPFS:`IPFS`,tech:`技术`,baike:`百科`,capitalmarket:`研报`},c={path:`/:category?`,categories:[`finance`],example:`/jinse/zhengce`,parameters:{category:`分类，见下表，默认为政策`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`分类`,maintainers:[`nczitzk`],handler:l,description:`| 政策    | 行情         | DeFi | 矿业  | 以太坊 2.0 |
| ------- | ------------ | ---- | ----- | ---------- |
| zhengce | fenxishishuo | defi | kuang | 以太坊 2.0 |

| 产业     | IPFS | 技术 | 百科  | 研报          |
| -------- | ---- | ---- | ----- | ------------- |
| industry | IPFS | tech | baike | capitalmarket |`};async function l(c){let{category:l=`zhengce`}=c.req.param(),u=c.req.query(`limit`)?Number.parseInt(c.req.query(`limit`),10):50,d=`https://www.jinse.cn`,f=new URL(`v6/www/information/list`,`https://api.jinse.cn`).href,p=d,{data:m}=await i(f,{searchParams:{catelogue_key:l,limit:u,flag:`up`}}),h=m.list.slice(0,u).map(e=>({title:e.title,link:e.extra.topic_url,description:t(a.join(r,`templates/description-d03b585b.art`),{images:e.extra.thumbnails_pics.length>0?e.extra.thumbnails_pics.map(e=>({src:e.replace(/_[^\W_]+(\.\w+)$/,`_true$1`)})):void 0,intro:e.extra.summary}),author:e.extra.nickname,guid:`jinse${/\/lives\//.test(e.extra.topic_url)?`-lives`:``}-${e.extra.topic_id}`,pubDate:n(e.extra.published_at,`X`),upvotes:e.extra.up_counts??0,downvotes:e.extra.down_counts??0,comments:e.extra.comment_count??0}));h=await Promise.all(h.map(n=>e.tryGet(n.link,async()=>{if(/\/lives\//.test(n.link))return n;let{data:e}=await i(n.link),s=o(e);return n.description+=t(a.join(r,`templates/description-d03b585b.art`),{description:s(`section.js-article-content`).html()||s(`div.js-article`).html()}),n.category=s(`section.js-article-tag_state_1 a span`).toArray().map(e=>s(e).text()),n})));let{data:g}=await i(p),_=o(g),v=_(`meta[name="author"]`).prop(`content`),y=_(`a.js-logoBox img`).prop(`src`),b=new URL(_(`link[rel="favicon"]`).prop(`href`),d).href;return{item:h,title:`${v} - ${Object.hasOwn(s,l)?s[l]:l}`,link:p,description:_(`meta[name="description"]`).prop(`content`),language:_(`html`).prop(`lang`),image:y,icon:b,logo:b,subtitle:_(`meta[name="keywords"]`).prop(`content`),author:v,allowEmpty:!0}}export{c as route};