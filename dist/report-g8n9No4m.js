import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import"./helpers-LVq640iW.js";import{cache_default as e}from"./cache-C3AIQtoX.js";import{art as t}from"./render-DE4LRFBD.js";import{parseDate as n}from"./parse-date-DHsdom8D.js";import"./ofetch-DRl42yaJ.js";import{__dirname as r}from"./esm-shims-BDPl6Msv.js";import{got_default as i}from"./got-BaOFZRd4.js";import{timezone as a}from"./timezone-BrxBCotj.js";import o from"node:path";import{load as s}from"cheerio";const c={path:[`/lc_report/:id?`,`/report/:id?`],categories:[`new-media`],example:`/logclub/lc_report`,parameters:{id:`报告 id，见下表，默认为罗戈研究出品`},features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportBT:!1,supportPodcast:!1,supportScihub:!1},name:`报告`,maintainers:[`nczitzk`],handler:l,description:`| 罗戈研究出品 | 物流报告       | 绿色双碳报告          |
| ------------ | -------------- | --------------------- |
| Report       | IndustryReport | GreenDualCarbonReport |`};async function l(c){let{id:l=`Report`}=c.req.param(),u=c.req.query(`limit`)?Number.parseInt(c.req.query(`limit`),10):11,d=`https://www.logclub.com`,f=new URL(`lc_report`,d).href,p=new URL(`front/lc_report/load${l}List`,d).href,{data:m}=await i.post(p,{json:{page:1}}),h=m.list.slice(0,u).map(e=>({title:e.title,link:new URL(`front/lc_report/get_report_info/${e.id}`,d).href,description:t(o.join(r,`templates/description-b417c82f.art`),{image:{src:e.img_url?.split(/\?/)[0]??void 0,alt:e.title}}),author:e.author,category:[e.channel_name],guid:`logclub-report-${e.id}`,pubDate:a(n(e.release_time),8)}));h=await Promise.all(h.map(n=>e.tryGet(n.link,async()=>{let{data:e}=await i(n.link),a=s(e);return a(`img`).each((e,n)=>{n=a(n),n.replaceWith(t(o.join(r,`templates/description-b417c82f.art`),{image:{src:n.prop(`src`)?.split(/\?/)[0]??void 0,alt:n.prop(`title`)}}))}),n.title=a(`h1`).first().text(),n.description+=t(o.join(r,`templates/description-b417c82f.art`),{description:a(`div.article-cont`).html()}),n.author=a(`div.lc-infos a`).toArray().map(e=>a(e).text()).join(`/`),n.category=[...new Set([...n.category??[],...a(`div.article-label-r a.label`).toArray().map(e=>a(e).text())])].filter(Boolean),n})));let{data:g}=await i(f),_=s(g),v=_(`div.this_nav`).text().trim(),y=new URL(_(`link[rel="shortcut icon"]`).prop(`href`),d).href,b=_(`meta[name="keywords"]`).prop(`content`);return{item:h,title:`${_(`title`).text()}${v}`,link:f,description:_(`meta[name="description"]`).prop(`content`),language:`zh`,image:new URL(_(`div.logo_img img`).prop(`src`),d).href,icon:y,logo:y,subtitle:b.replaceAll(`,`,``),author:b.split(/,/)[0]}}export{c as route};