import"./config-HRWLmo66.js";import"./logger-DHpG8Bim.js";import{art as e}from"./render-DE4LRFBD.js";import{parseDate as t}from"./parse-date-DHsdom8D.js";import{ofetch_default as n}from"./ofetch-DRl42yaJ.js";import{__dirname as r}from"./esm-shims-BDPl6Msv.js";import{ViewType as i}from"./types-D9T3SQ-7.js";import a from"node:path";import{load as o}from"cheerio";const s=async i=>{let s=Number.parseInt(i.req.query(`limit`)??`100`,10),c=`https://tf.121.com.cn`,l=`https://wx.121.com.cn`,u=new URL(`web/weatherLive/`,c).href,d=new URL(`weather/weibo/message.js`,c).href,f=await n(u),p=o(f),m=p(`html`).attr(`lang`)??`zh`,h=await n(d),g=await h.text(),_=JSON.parse(g.split(/var\smessage=/).pop()).slice(0,s).map(n=>{let i=n.Title,o=e(a.join(r,`templates/description-ae443df5.art`),{description:n.Content,images:n.Img?.map(e=>({src:new URL(`WeChat/data/weiweb/images/lwspic/${e}`,l).href,alt:i}))}),s=n.DDatetime,d=u,f=`121-${i}-${s}`,p=n.Img?.length>0?new URL(`WeChat/data/weiweb/images/lwspic/${n.Img[0]}`,l).href:void 0,h=s,g={title:i,description:o,pubDate:s?t(s):void 0,link:d??new URL(n.id,c).href,guid:f,id:f,content:{html:o,text:o},image:p,banner:p,updated:h?t(h):void 0,language:m};return g}),v=p(`title`).text();return{title:v,description:v,link:u,item:_,allowEmpty:!0,image:p(`img`).first().attr(`src`)?new URL(p(`img`).first().attr(`src`),c).href:void 0,author:p(`div#webnameDiv`).text(),language:m,id:u}},c={path:`/weatherLive`,name:`深圳天气直播`,url:`tf.121.com.cn`,maintainers:[`nczitzk`],handler:s,example:`/121/weatherLive`,parameters:void 0,description:void 0,categories:[`forecast`],features:{requireConfig:!1,requirePuppeteer:!1,antiCrawler:!1,supportRadar:!0,supportBT:!1,supportPodcast:!1,supportScihub:!1},radar:[{source:[`tf.121.com.cn`,`tf.121.com.cn/web/weatherLive`],target:`/weatherLive`}],view:i.Notifications};export{s as handler,c as route};